


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper-devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper-devguide/styles/styles.css"></head>
<body data-id="PSI/Reference/Xml/Overview">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="overview" class="elem-anchor"></a>
<h1>Overview<a href="#overview" class="anchor-link"><span></span></a></h1>

<ul id="markdown-toc">
  <li><a href="#tree-structure" id="markdown-toc-tree-structure"><span>Tree structure<a href="#tree-structure" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#tree-nodes" id="markdown-toc-tree-nodes"><span>Tree nodes<a href="#tree-nodes" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#tokens" id="markdown-toc-tokens"><span>Tokens<a href="#tokens" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#file-node" id="markdown-toc-file-node"><span>File node<a href="#file-node" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xml-tags" id="markdown-toc-xml-tags"><span>XML tags<a href="#xml-tags" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xml-attributes" id="markdown-toc-xml-attributes"><span>XML attributes<a href="#xml-attributes" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#processing-instructions" id="markdown-toc-processing-instructions"><span>Processing Instructions<a href="#processing-instructions" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
  <li><a href="#dtd" id="markdown-toc-dtd"><span>DTD<a href="#dtd" class="anchor-link"><span></span></a></span></a></li>
  <li><a href="#derived-xml-languages" id="markdown-toc-derived-xml-languages"><span>Derived XML languages<a href="#derived-xml-languages" class="anchor-link"><span></span></a></span></a></li>
  <li><a href="#manipulating-the-tree" id="markdown-toc-manipulating-the-tree"><span>Manipulating the tree<a href="#manipulating-the-tree" class="anchor-link"><span></span></a></span></a></li>
  <li><a href="#navigation" id="markdown-toc-navigation"><span>Navigation<a href="#navigation" class="anchor-link"><span></span></a></span></a></li>
  <li><a href="#utilities" id="markdown-toc-utilities"><span>Utilities<a href="#utilities" class="anchor-link"><span></span></a></span></a></li>
</ul>

<a name="tree-structure" class="elem-anchor"></a>
<h2>Tree structure<a href="#tree-structure" class="anchor-link"><span></span></a></h2>

<p>Thanks to the simple and regular structure of XML, the XML PSI tree is fairly small, and pretty easy to understand. However, the PSI tree should not be confused with a DOM. The PSI tree is an abstract syntax tree, and models all of the syntax in an XML file, while an XML DOM is a (light) abstraction on top of the file. A DOM lists elements and attributes, while an abstract syntax tree will also list whitespace, and the constructs used to create an element (e.g. the opening and closing tags).</p>

<p>A good example here is that the text contents of an XML element is split into text tokens and whitespace nodes. Even if the owning XML element has the <code class="code highlight language-text">xml:space=&quot;preserve&quot;</code> attribute set, the tree doesn’t change, and the whitespace nodes are still added. In other words, the semantic nature of the <code class="code highlight language-text">xml:space</code> attribute isn’t reflected in the abstract syntax tree.</p>

<p>Since XML is a hierarchical structure, care should also be taken not to confuse child nodes in the tree with children in the XML DOM. For example, the children of an XML element in the PSI tree include the nodes used to construct the opening and closing tags, as well as the inner nodes of the elements (whitespace, child tags, etc).</p>

<p>See the <a href="TreeNodes.html"><span>Tree Nodes reference section</span></a> for more details of the XML tree nodes.</p>

<a name="tree-nodes" class="elem-anchor"></a>
<h3>Tree nodes<a href="#tree-nodes" class="anchor-link"><span></span></a></h3>

<p>Each node in the XML tree derives from <a href="TreeNodes.html#ixmltreenode"><span><code class="code highlight language-text">IXmlTreeNode</code></span></a>:</p>

<!-- Begin IXmlTreeNode -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlTreeNode</span> <span class="p">:</span>
  <span class="n">ITreeNode</span>
<span class="p">{</span>
  <span class="n">XmlTokenTypes</span> <span class="n">XmlTokenTypes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

  <span class="n">TReturn</span> <span class="n">AcceptVisitor</span><span class="p">&lt;</span><span class="n">TContext</span><span class="p">,</span> <span class="n">TReturn</span><span class="p">&gt;(</span><span class="n">IXmlTreeVisitor</span><span class="p">&lt;</span><span class="n">TContext</span><span class="p">,</span> <span class="n">TReturn</span><span class="p">&gt;</span> <span class="n">visitor</span><span class="p">,</span> <span class="n">TContext</span> <span class="n">context</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<!-- End IXmlTreeNode -->

<p>The <code class="code highlight language-text">XmlTokenTypes</code> property provides access to the token node type instances assigned to the token nodes when building the tree. These instances are the values returned from <code class="code highlight language-text">ITreeNode.NodeType</code>, and <code class="code highlight language-text">ITokenNode.GetTokenType()</code>. It can be used to compare against the token node type reported by a token node in order to find a particular token type (e.g. look for tokens of type <code class="code highlight language-text">XmlTokenTypes.COMMENT_START</code>). It is also used by the XML file parser to create token nodes via the token node type instances’ <code class="code highlight language-text">Create</code> method. This might return a derived instance for some XML languages, such as XAML.</p>

<p>The <code class="code highlight language-text">AcceptVisitor</code> method implements the <a href="http://en.wikipedia.org/wiki/Visitor_pattern" data-bypass="yes"><span>Visitor pattern</span></a>. It will call the strongly typed <code class="code highlight language-text">Visit</code> method of the <code class="code highlight language-text">IXmlTreeVisitor</code> instance passed in.</p>

<a name="tokens" class="elem-anchor"></a>
<h3>Tokens<a href="#tokens" class="anchor-link"><span></span></a></h3>

<p>All tokens in the tree derive from <a href="TreeNodes.html#ixmltoken"><span><code class="code highlight language-text">IXmlToken</code></span></a>, which in turn derives from <a href="TreeNodes.html#ixmltreenode"><span><code class="code highlight language-text">IXmlTreeNode</code></span></a>. Remember that a token is a leaf element in the tree - it doesn’t have any children, and is used to build the higher level tree nodes (e.g. an xml tag contains the tokens for <code class="code highlight language-text">&lt;</code>, the tag name identifier, <code class="code highlight language-text">&gt;</code> and so on).</p>

<!-- Begin IXmlToken -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlToken</span> <span class="p">:</span>
  <span class="n">IXmlTreeNode</span><span class="p">,</span>
  <span class="n">ITokenNode</span><span class="p">,</span>
  <span class="n">ITreeNode</span>
<span class="p">{</span>
  <span class="k">new</span> <span class="n">XmlTokenNodeType</span> <span class="nf">GetTokenType</span><span class="p">();</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmltreenode"><span>IXmlTreeNode</span></a></li>
</ul>

<!-- End IXmlToken -->

<p>The <code class="code highlight language-text">ITokenNode.GetTokenType</code> method is hidden by a new method of the same name, but that returns an instance of <code class="code highlight language-text">XmlTokenNodeType</code>, rather than <code class="code highlight language-text">TokenNodeType</code>. <code class="code highlight language-text">XmlTokenNodeType</code> derives from the <code class="code highlight language-text">TokenNodeType</code> abstract class and adds a single property, that returns the <code class="code highlight language-text">XmlTokenTypes</code> class that lists all the known token node types. This class can be a derived instance for some XML languages, such as XAML.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="n">XmlTokenTypes</span> <span class="n">XmlTokenTypes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span></code></pre>

<a name="file-node" class="elem-anchor"></a>
<h3>File node<a href="#file-node" class="anchor-link"><span></span></a></h3>

<p>The root node of an XML file is <a href="TreeNodes.html#ixmlfile"><span><code class="code highlight language-text">IXmlFile</code></span></a>:</p>

<!-- Begin IXmlFile -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlFile</span> <span class="p">:</span>
  <span class="n">IFile</span><span class="p">,</span>
  <span class="n">IXmlTagContainer</span><span class="p">,</span>
  <span class="n">IXmlDocumentNode</span><span class="p">,</span>
  <span class="n">IXmlTreeNode</span><span class="p">,</span>
  <span class="n">ITreeNode</span>
<span class="p">{</span>
  <span class="n">TreeNodeCollection</span><span class="p">&lt;</span><span class="n">IProcessingInstruction</span><span class="p">&gt;</span> <span class="n">ProcessingInstructions</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">XmlElementTypes</span> <span class="n">XmlElementTypes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#iprocessinginstruction"><span>IProcessingInstruction</span></a>, <a href="TreeNodes.html#ixmldocumentnode"><span>IXmlDocumentNode</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a>, <a href="TreeNodes.html#ixmltreenode"><span>IXmlTreeNode</span></a></li>
</ul>

<!-- End IXmlFile -->

<p>The <code class="code highlight language-text">XmlElementTypes</code> property provides access to the composite node type instances assigned to the composite, non-leaf nodes when building the tree. These instances are the values returned from <code class="code highlight language-text">ITreeNode.NodeType</code>. It can be used to compare against the node type of any node, to look for nodes of a certain type, and is also used by the XML file parser to create element nodes via the element node type instances’ <code class="code highlight language-text">Create</code> method. The type of <code class="code highlight language-text">XmlElementTypes</code> might be a derived instance, depending on the XML language.</p>

<p>The <code class="code highlight language-text">IXmlFile</code> directly exposes a collection of processing instructions. This only returns processing instructions that implement <a href="TreeNodes.html#iprocessinginstruction"><span><code class="code highlight language-text">IProcessingInstruction</code></span></a>, and despite its name, the <a href="TreeNodes.html#ixmlprocessinginstruction"><span><code class="code highlight language-text">IXmlProcessingInstruction</code></span></a> that represents the XML declaration doesn’t get returned in this collection. To get at the XML declaration, you need to get it directly from the child nodes:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="kt">var</span> <span class="n">xmlDeclarations</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">Children</span><span class="p">&lt;</span><span class="n">IXmlProcessingInstruction</span><span class="p">&gt;();</span></code></pre>

<p>The inherited <a href="TreeNodes.html#ixmltagcontainer"><span><code class="code highlight language-text">IXmlTagContainer</code></span></a> interface provides child tag access and manipulation functions.</p>

<p>It also implements the <a href="TreeNodes.html#ixmldocumentnode"><span><code class="code highlight language-text">IXmlDocumentNode</code></span></a> marker interface.</p>

<a name="xml-tags" class="elem-anchor"></a>
<h3>XML tags<a href="#xml-tags" class="anchor-link"><span></span></a></h3>

<p>An XML tag is represented with the <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a> interface. This is where it is important not to confuse child tags with child nodes. The <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a> interface represents the span from the opening <code class="code highlight language-text">&lt;</code> character to the closing <code class="code highlight language-text">&gt;</code> character of an XML element. Its child nodes in the tree split this span further, into a header, an optional footer and the content nodes.</p>

<p>The header is represented with the <a href="TreeNodes.html#ixmltagheader"><span><code class="code highlight language-text">IXmlTagHeader</code></span></a> interface, and covers the span from the opening <code class="code highlight language-text">&lt;</code> character to the closing <code class="code highlight language-text">&gt;</code> of the <strong>opening</strong> part of the XML element. E.g. <code class="code highlight language-text">&lt;foo baz=&quot;quux&quot;&gt;</code> only, and not including the closing element <code class="code highlight language-text">&lt;/foo&gt;</code>. This means that the header span also includes attributes, and the tree nodes representing the attributes are indeed child nodes of the tag header.</p>

<p>The footer is the closing element (<code class="code highlight language-text">&lt;/foo&gt;</code>), which may not be included in the tree if the XML element is self-closed (<code class="code highlight language-text">&lt;foo /&gt;</code>).</p>

<p>The inner child nodes are either text (<a href="TreeNodes.html#ixmlfloatingtexttokennode"><span><code class="code highlight language-text">IXmlFloatingTextTokenNode</code></span></a>, which also includes whitespace), or other nodes such as <a href="TreeNodes.html#ixmlcdata"><span><code class="code highlight language-text">IXmlCData</code></span></a>, <a href="TreeNodes.html#ixmlentitytokennode"><span><code class="code highlight language-text">IXmlEntityTokenNode</code></span></a> or <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a>.</p>

<!-- Begin IXmlTag -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlTag</span> <span class="p">:</span>
  <span class="n">IXmlTreeNode</span><span class="p">,</span>
  <span class="n">IXmlTagContainer</span><span class="p">,</span>
  <span class="n">ITreeNode</span>
<span class="p">{</span>
  <span class="n">IXmlTagFooter</span> <span class="n">Footer</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">IXmlTagHeader</span> <span class="n">Header</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">string</span> <span class="n">InnerText</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">TreeNodeCollection</span><span class="p">&lt;</span><span class="n">IXmlToken</span><span class="p">&gt;</span> <span class="n">InnerTextTokens</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">string</span> <span class="n">InnerValue</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">ITreeRange</span> <span class="n">InnerXml</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">bool</span> <span class="n">IsEmptyTag</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

  <span class="n">TXmlAttribute</span> <span class="n">AddAttributeAfter</span><span class="p">&lt;</span><span class="n">TXmlAttribute</span><span class="p">&gt;(</span><span class="n">TXmlAttribute</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">IXmlAttribute</span> <span class="n">anchor</span><span class="p">);</span>
  <span class="n">TXmlAttribute</span> <span class="n">AddAttributeBefore</span><span class="p">&lt;</span><span class="n">TXmlAttribute</span><span class="p">&gt;(</span><span class="n">TXmlAttribute</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">IXmlAttribute</span> <span class="n">anchor</span><span class="p">);</span>

  <span class="k">void</span> <span class="nf">RemoveAttribute</span><span class="p">(</span><span class="n">IXmlAttribute</span> <span class="n">attribute</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a>, <a href="TreeNodes.html#ixmltagfooter"><span>IXmlTagFooter</span></a>, <a href="TreeNodes.html#ixmltagheader"><span>IXmlTagHeader</span></a>, <a href="TreeNodes.html#ixmltoken"><span>IXmlToken</span></a>, <a href="TreeNodes.html#ixmltreenode"><span>IXmlTreeNode</span></a></li>
</ul>

<!-- End IXmlTag -->

<a name="xml-attributes" class="elem-anchor"></a>
<h3>XML attributes<a href="#xml-attributes" class="anchor-link"><span></span></a></h3>

<p>Attributes are accessible via the <a href="TreeNodes.html#ixmlattributecontainer"><span><code class="code highlight language-text">IXmlAttributeContainer</code></span></a> interface, mostly implemented by <a href="TreeNodes.html#ixmltagheader"><span><code class="code highlight language-text">IXmlTagHeader</code></span></a>, but also by the XML declaration <a href="TreeNodes.html#ixmlprocessinginstruction"><span><code class="code highlight language-text">IXmlProcessingInstruction</code></span></a>.</p>

<!-- Begin IXmlAttributeContainer -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlAttributeContainer</span> <span class="p">:</span>
  <span class="n">IXmlTreeNode</span><span class="p">,</span>
  <span class="n">ITreeNode</span>
<span class="p">{</span>
  <span class="n">TreeNodeCollection</span><span class="p">&lt;</span><span class="n">IXmlAttribute</span><span class="p">&gt;</span> <span class="n">Attributes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">TreeNodeEnumerable</span><span class="p">&lt;</span><span class="n">IXmlAttribute</span><span class="p">&gt;</span> <span class="n">AttributesEnumerable</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">string</span> <span class="n">ContainerName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmltreenode"><span>IXmlTreeNode</span></a></li>
</ul>

<!-- End IXmlAttributeContainer -->

<p>Methods to add and remove attributes are available on <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a>.</p>

<a name="processing-instructions" class="elem-anchor"></a>
<h3>Processing Instructions<a href="#processing-instructions" class="anchor-link"><span></span></a></h3>

<p>Processing instructions are represented with the <a href="TreeNodes.html#iprocessinginstruction"><span><code class="code highlight language-text">IProcessingInstruction</code></span></a> interface. This is a simple interface, providing access to the target name, and a string representing the unparsed content.</p>

<a name="dtd" class="elem-anchor"></a>
<h2>DTD<a href="#dtd" class="anchor-link"><span></span></a></h2>

<aside class="todo">
  <p> Write about DTD, inline and standalone</p>
</aside>

<a name="derived-xml-languages" class="elem-anchor"></a>
<h2>Derived XML languages<a href="#derived-xml-languages" class="anchor-link"><span></span></a></h2>

<aside class="todo">
  <p> Write about derived XML languages. How does this relate to the other PSI reference sections?</p>
</aside>

<a name="manipulating-the-tree" class="elem-anchor"></a>
<h2>Manipulating the tree<a href="#manipulating-the-tree" class="anchor-link"><span></span></a></h2>

<aside class="todo">
  <p> Write about manipulating the tree. Push this to own page? E.g. element factories</p>
</aside>

<a name="navigation" class="elem-anchor"></a>
<h2>Navigation<a href="#navigation" class="anchor-link"><span></span></a></h2>

<p>The XML PSI implementation includes several <a href="Navigators.html"><span>navigator classes</span></a>. As usual, the naming follows a convention - the classes are named after the tree node you are trying to <strong>navigate to</strong>, to find, suffixed with ‘Navigator’, for example, <code class="code highlight language-text">XmlTagNavigator</code>. And the methods are named after the tree node you are <strong>navigating from</strong>, e.g. <code class="code highlight language-text">XmlTagNavigator.GetByTagHeader</code>.</p>

<a name="utilities" class="elem-anchor"></a>
<h2>Utilities<a href="#utilities" class="anchor-link"><span></span></a></h2>

<p>The XML PSI implementation includes a couple of <a href="Utils.html"><span>utility classes</span></a>, some for manipulation of the tree, and some for helper methods for handling references within XML files to CLR types (e.g. web.config files)</p>


                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper-devguide/app/js/main.build" data-baseurl="/resharper-devguide/" src="/resharper-devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

