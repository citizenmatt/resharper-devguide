


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper-devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper-devguide/styles/styles.css"></head>
<body data-id="PSI/Reference/Xml/ElementFactories">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="elementfactories" class="elem-anchor"></a>
<h1>ElementFactories<a href="#elementfactories" class="anchor-link"><span></span></a></h1>

<!-- Not auto-indexed, so we can split definitions between XML and XML DTD.
     Also not including ClrDocCommentElementFactoryImpl + DocCommentElementFactory.
     These are XML Doc Comment PSI element factories -->

<p>The XML PSI has several classes related to element factories, that is, for creating <a href="TreeNodes.html#ixmltreenode"><span><code class="code highlight language-text">IXmlTreeNode</code></span></a> derived instances. Some of the classes are for internal use, or implementation details. They are documented here for completeness, and to avoid confusion when spelunking around the code in dotPeek.</p>

<p>The <a href="#xmlelementfactory"><span><code class="code highlight language-text">XmlElementFactory</code></span></a> class is the class to use for creating tags, attributes or an entire <a href="#ixmlfile"><span><code class="code highlight language-text">IXmlFile</code></span></a> instance. Use the <code class="code highlight language-text">XmlElementFactory.GetInstance</code> method to get a copy of the class. The <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a> interface is a lower level API which can create any <a href="TreeNodes.html#ixmltreenode"><span><code class="code highlight language-text">IXmlTreeNode</code></span></a> instance. The default implementation is <a href="#xmltreenodefactory"><span><code class="code highlight language-text">XmlTreeNodeFactory</code></span></a> and can be retrieved using the <code class="code highlight language-text">XmlTreeNodeFactory.GetInstance</code> method.</p>

<p>All other classes and interfaces are used internally, and will probably not be used from client code.</p>

<ul id="markdown-toc">
  <li><a href="#d" id="markdown-toc-d"><span>D<a href="#d" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#defaultxmlelementfactorycontext" id="markdown-toc-defaultxmlelementfactorycontext"><span>DefaultXmlElementFactoryContext<a href="#defaultxmlelementfactorycontext" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#delegatingxmlelementfactory" id="markdown-toc-delegatingxmlelementfactory"><span>DelegatingXmlElementFactory<a href="#delegatingxmlelementfactory" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
  <li><a href="#i" id="markdown-toc-i"><span>I<a href="#i" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#ixmlelementfactory" id="markdown-toc-ixmlelementfactory"><span>IXmlElementFactory<a href="#ixmlelementfactory" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#ixmlelementfactorycontext" id="markdown-toc-ixmlelementfactorycontext"><span>IXmlElementFactoryContext<a href="#ixmlelementfactorycontext" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
  <li><a href="#r" id="markdown-toc-r"><span>R<a href="#r" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#resyncxmlelementfactory" id="markdown-toc-resyncxmlelementfactory"><span>ResyncXmlElementFactory<a href="#resyncxmlelementfactory" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#resyncxmlelementfactorycontext" id="markdown-toc-resyncxmlelementfactorycontext"><span>ResyncXmlElementFactoryContext<a href="#resyncxmlelementfactorycontext" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
  <li><a href="#x" id="markdown-toc-x"><span>X<a href="#x" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#xmlelementfactory" id="markdown-toc-xmlelementfactory"><span>XmlElementFactory<a href="#xmlelementfactory" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlelementfactorylttxmllanguagegt" id="markdown-toc-xmlelementfactorylttxmllanguagegt"><span>XmlElementFactory&lt;TXmlLanguage&gt;<a href="#xmlelementfactorylttxmllanguagegt" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlelementfactoryforcreateattribute" id="markdown-toc-xmlelementfactoryforcreateattribute"><span>XmlElementFactoryForCreateAttribute<a href="#xmlelementfactoryforcreateattribute" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlelementfactoryforcreatetag" id="markdown-toc-xmlelementfactoryforcreatetag"><span>XmlElementFactoryForCreateTag<a href="#xmlelementfactoryforcreatetag" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmltreenodefactory" id="markdown-toc-xmltreenodefactory"><span>XmlTreeNodeFactory<a href="#xmltreenodefactory" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
</ul>

<a name="d" class="elem-anchor"></a>
<h2>D<a href="#d" class="anchor-link"><span></span></a></h2>

<a name="defaultxmlelementfactorycontext" class="elem-anchor"></a>
<h3>DefaultXmlElementFactoryContext<a href="#defaultxmlelementfactorycontext" class="anchor-link"><span></span></a></h3>

<!-- Begin DefaultXmlElementFactoryContext -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">DefaultXmlElementFactoryContext</span> <span class="p">:</span>
  <span class="n">IXmlElementFactoryContext</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">DefaultXmlElementFactoryContext</span> <span class="n">Instance</span><span class="p">;</span>

  <span class="k">public</span> <span class="n">T</span> <span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">ITreeNode</span> <span class="n">currentNode</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">returnCurrent</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">GetParentTag</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">currentTag</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a></li>
</ul>

<!-- End DefaultXmlElementFactoryContext -->

<p>Default implementation of <a href="#ixmlelementfactorycontext"><span><code class="code highlight language-text">IXmlElementFactoryContext</code></span></a> that defers to <code class="code highlight language-text">ITreeNode.GetContainingNode&lt;T&gt;()</code> and <code class="code highlight language-text">XmlTagNavigator.GetByTag()</code>.</p>

<a name="delegatingxmlelementfactory" class="elem-anchor"></a>
<h3>DelegatingXmlElementFactory<a href="#delegatingxmlelementfactory" class="anchor-link"><span></span></a></h3>

<!-- Begin DelegatingXmlElementFactory -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">DelegatingXmlElementFactory</span> <span class="p">:</span>
  <span class="n">IXmlElementFactory</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">DelegatingXmlElementFactory</span><span class="p">(</span><span class="n">IXmlElementFactory</span> <span class="n">factory</span><span class="p">);</span>

  <span class="n">IXmlElementFactory</span> <span class="n">Factory</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">PsiLanguageType</span> <span class="n">LanguageType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">XmlElementTypes</span> <span class="n">XmlElementType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">XmlTokenTypes</span> <span class="n">XmlTokenTypes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

  <span class="k">public</span> <span class="n">IAnyContent</span> <span class="nf">CreateAnyContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IAttDef</span> <span class="nf">CreateAttDef</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateAttribute</span><span class="p">(</span><span class="n">IXmlIdentifier</span> <span class="n">nameIdentifier</span><span class="p">,</span> <span class="n">IXmlAttributeContainer</span> <span class="n">attributeContainer</span><span class="p">,</span> <span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlAttributeValue</span> <span class="nf">CreateAttributeValue</span><span class="p">(</span><span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IAttType</span> <span class="nf">CreateAttType</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlCData</span> <span class="nf">CreateCData</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlComment</span> <span class="nf">CreateComment</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDocTypeDeclaration</span> <span class="nf">CreateDocTypeDeclaration</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDAttListDecl</span> <span class="nf">CreateDTDAttListDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDElementDecl</span> <span class="nf">CreateDTDElementDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDEntityDecl</span> <span class="nf">CreateDTDEntityDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDNotationDecl</span> <span class="nf">CreateDTDNotationDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IEmptyContent</span> <span class="nf">CreateEmptyContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlSyntaxErrorElement</span> <span class="nf">CreateError</span><span class="p">(</span><span class="n">XmlSyntaxErrorType</span> <span class="n">errorType</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlFile</span> <span class="nf">CreateFile</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IGrouppedContent</span> <span class="nf">CreateGrouppedContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlIdentifier</span> <span class="nf">CreateIdentifier</span><span class="p">(</span><span class="n">ITokenIntern</span> <span class="n">internalizer</span><span class="p">,</span> <span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IDTDBody</span> <span class="nf">CreateIntSubset</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDNDataDecl</span> <span class="nf">CreateNDataDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IProcessingInstruction</span> <span class="nf">CreatePI</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlProcessingInstruction</span> <span class="nf">CreatePIXml</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IExternalId</span> <span class="nf">CreatePublicExternalID</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IRepetitionContent</span> <span class="nf">CreateRepetionContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">CreateRootTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IElementContent</span> <span class="nf">CreateSimpleContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IExternalId</span> <span class="nf">CreateSystemExternalID</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">CreateTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlTag</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTagFooter</span> <span class="nf">CreateTagFooter</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTagHeader</span> <span class="nf">CreateTagHeader</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlToken</span> <span class="nf">CreateToken</span><span class="p">(</span><span class="n">ITokenIntern</span> <span class="n">internalizer</span><span class="p">,</span> <span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodesDTD.html#ianycontent"><span>IAnyContent</span></a>, <a href="TreeNodesDTD.html#iattdef"><span>IAttDef</span></a>, <a href="TreeNodesDTD.html#iatttype"><span>IAttType</span></a>, <a href="TreeNodesDTD.html#idoctypedeclaration"><span>IDocTypeDeclaration</span></a>, <a href="TreeNodesDTD.html#idtdattlistdecl"><span>IDTDAttListDecl</span></a>, <a href="TreeNodesDTD.html#idtdbody"><span>IDTDBody</span></a>, <a href="TreeNodesDTD.html#idtdelementdecl"><span>IDTDElementDecl</span></a>, <a href="TreeNodesDTD.html#idtdentitydecl"><span>IDTDEntityDecl</span></a>, <a href="TreeNodesDTD.html#idtdndatadecl"><span>IDTDNDataDecl</span></a>, <a href="TreeNodesDTD.html#idtdnotationdecl"><span>IDTDNotationDecl</span></a>, <a href="TreeNodesDTD.html#ielementcontent"><span>IElementContent</span></a>, <a href="TreeNodesDTD.html#iemptycontent"><span>IEmptyContent</span></a>, <a href="TreeNodesDTD.html#iexternalid"><span>IExternalId</span></a>, <a href="TreeNodesDTD.html#igrouppedcontent"><span>IGrouppedContent</span></a>, <a href="TreeNodes.html#iprocessinginstruction"><span>IProcessingInstruction</span></a>, <a href="TreeNodesDTD.html#irepetitioncontent"><span>IRepetitionContent</span></a>, <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlattributecontainer"><span>IXmlAttributeContainer</span></a>, <a href="TreeNodes.html#ixmlattributevalue"><span>IXmlAttributeValue</span></a>, <a href="TreeNodes.html#ixmlcdata"><span>IXmlCData</span></a>, <a href="TreeNodes.html#ixmlcomment"><span>IXmlComment</span></a>, <a href="ElementFactories.html#ixmlelementfactory"><span>IXmlElementFactory</span></a>, <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmlfile"><span>IXmlFile</span></a>, <a href="TreeNodes.html#ixmlidentifier"><span>IXmlIdentifier</span></a>, <a href="TreeNodes.html#ixmlprocessinginstruction"><span>IXmlProcessingInstruction</span></a>, <a href="TreeNodes.html#ixmlsyntaxerrorelement"><span>IXmlSyntaxErrorElement</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a>, <a href="TreeNodes.html#ixmltagfooter"><span>IXmlTagFooter</span></a>, <a href="TreeNodes.html#ixmltagheader"><span>IXmlTagHeader</span></a>, <a href="TreeNodes.html#ixmltoken"><span>IXmlToken</span></a></li>
</ul>

<!-- End DelegatingXmlElementFactory -->

<a name="i" class="elem-anchor"></a>
<h2>I<a href="#i" class="anchor-link"><span></span></a></h2>

<a name="ixmlelementfactory" class="elem-anchor"></a>
<h3>IXmlElementFactory<a href="#ixmlelementfactory" class="anchor-link"><span></span></a></h3>

<!-- Begin IXmlElementFactory -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlElementFactory</span>
<span class="p">{</span>
  <span class="n">PsiLanguageType</span> <span class="n">LanguageType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">XmlElementTypes</span> <span class="n">XmlElementType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">XmlTokenTypes</span> <span class="n">XmlTokenTypes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

  <span class="n">IAnyContent</span> <span class="nf">CreateAnyContent</span><span class="p">();</span>
  <span class="n">IAttDef</span> <span class="nf">CreateAttDef</span><span class="p">();</span>
  <span class="n">IXmlAttribute</span> <span class="nf">CreateAttribute</span><span class="p">(</span><span class="n">IXmlIdentifier</span> <span class="n">nameIdentifier</span><span class="p">,</span> <span class="n">IXmlAttributeContainer</span> <span class="n">attributeContainer</span><span class="p">,</span> <span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="n">IXmlAttributeValue</span> <span class="nf">CreateAttributeValue</span><span class="p">(</span><span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
  <span class="n">IAttType</span> <span class="nf">CreateAttType</span><span class="p">();</span>
  <span class="n">IXmlCData</span> <span class="nf">CreateCData</span><span class="p">();</span>
  <span class="n">IXmlComment</span> <span class="nf">CreateComment</span><span class="p">();</span>
  <span class="n">IDocTypeDeclaration</span> <span class="nf">CreateDocTypeDeclaration</span><span class="p">();</span>
  <span class="n">IDTDAttListDecl</span> <span class="nf">CreateDTDAttListDecl</span><span class="p">();</span>
  <span class="n">IDTDElementDecl</span> <span class="nf">CreateDTDElementDecl</span><span class="p">();</span>
  <span class="n">IDTDEntityDecl</span> <span class="nf">CreateDTDEntityDecl</span><span class="p">();</span>
  <span class="n">IDTDNotationDecl</span> <span class="nf">CreateDTDNotationDecl</span><span class="p">();</span>
  <span class="n">IEmptyContent</span> <span class="nf">CreateEmptyContent</span><span class="p">();</span>
  <span class="n">IXmlSyntaxErrorElement</span> <span class="nf">CreateError</span><span class="p">(</span><span class="n">XmlSyntaxErrorType</span> <span class="n">errorType</span><span class="p">);</span>
  <span class="n">IXmlFile</span> <span class="nf">CreateFile</span><span class="p">();</span>
  <span class="n">IGrouppedContent</span> <span class="nf">CreateGrouppedContent</span><span class="p">();</span>
  <span class="n">IXmlIdentifier</span> <span class="nf">CreateIdentifier</span><span class="p">(</span><span class="n">ITokenIntern</span> <span class="n">internalizer</span><span class="p">,</span> <span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
  <span class="n">IDTDBody</span> <span class="nf">CreateIntSubset</span><span class="p">();</span>
  <span class="n">IDTDNDataDecl</span> <span class="nf">CreateNDataDecl</span><span class="p">();</span>
  <span class="n">IProcessingInstruction</span> <span class="nf">CreatePI</span><span class="p">();</span>
  <span class="n">IXmlProcessingInstruction</span> <span class="nf">CreatePIXml</span><span class="p">();</span>
  <span class="n">IExternalId</span> <span class="nf">CreatePublicExternalID</span><span class="p">();</span>
  <span class="n">IRepetitionContent</span> <span class="nf">CreateRepetionContent</span><span class="p">();</span>
  <span class="n">IXmlTag</span> <span class="nf">CreateRootTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="n">IElementContent</span> <span class="nf">CreateSimpleContent</span><span class="p">();</span>
  <span class="n">IExternalId</span> <span class="nf">CreateSystemExternalID</span><span class="p">();</span>
  <span class="n">IXmlTag</span> <span class="nf">CreateTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlTag</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="n">IXmlTagFooter</span> <span class="nf">CreateTagFooter</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="n">IXmlTagHeader</span> <span class="nf">CreateTagHeader</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="n">IXmlToken</span> <span class="nf">CreateToken</span><span class="p">(</span><span class="n">ITokenIntern</span> <span class="n">internalizer</span><span class="p">,</span> <span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodesDTD.html#ianycontent"><span>IAnyContent</span></a>, <a href="TreeNodesDTD.html#iattdef"><span>IAttDef</span></a>, <a href="TreeNodesDTD.html#iatttype"><span>IAttType</span></a>, <a href="TreeNodesDTD.html#idoctypedeclaration"><span>IDocTypeDeclaration</span></a>, <a href="TreeNodesDTD.html#idtdattlistdecl"><span>IDTDAttListDecl</span></a>, <a href="TreeNodesDTD.html#idtdbody"><span>IDTDBody</span></a>, <a href="TreeNodesDTD.html#idtdelementdecl"><span>IDTDElementDecl</span></a>, <a href="TreeNodesDTD.html#idtdentitydecl"><span>IDTDEntityDecl</span></a>, <a href="TreeNodesDTD.html#idtdndatadecl"><span>IDTDNDataDecl</span></a>, <a href="TreeNodesDTD.html#idtdnotationdecl"><span>IDTDNotationDecl</span></a>, <a href="TreeNodesDTD.html#ielementcontent"><span>IElementContent</span></a>, <a href="TreeNodesDTD.html#iemptycontent"><span>IEmptyContent</span></a>, <a href="TreeNodesDTD.html#iexternalid"><span>IExternalId</span></a>, <a href="TreeNodesDTD.html#igrouppedcontent"><span>IGrouppedContent</span></a>, <a href="TreeNodes.html#iprocessinginstruction"><span>IProcessingInstruction</span></a>, <a href="TreeNodesDTD.html#irepetitioncontent"><span>IRepetitionContent</span></a>, <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlattributecontainer"><span>IXmlAttributeContainer</span></a>, <a href="TreeNodes.html#ixmlattributevalue"><span>IXmlAttributeValue</span></a>, <a href="TreeNodes.html#ixmlcdata"><span>IXmlCData</span></a>, <a href="TreeNodes.html#ixmlcomment"><span>IXmlComment</span></a>, <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmlfile"><span>IXmlFile</span></a>, <a href="TreeNodes.html#ixmlidentifier"><span>IXmlIdentifier</span></a>, <a href="TreeNodes.html#ixmlprocessinginstruction"><span>IXmlProcessingInstruction</span></a>, <a href="TreeNodes.html#ixmlsyntaxerrorelement"><span>IXmlSyntaxErrorElement</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a>, <a href="TreeNodes.html#ixmltagfooter"><span>IXmlTagFooter</span></a>, <a href="TreeNodes.html#ixmltagheader"><span>IXmlTagHeader</span></a>, <a href="TreeNodes.html#ixmltoken"><span>IXmlToken</span></a></li>
</ul>

<!-- End IXmlElementFactory -->

<a name="ixmlelementfactorycontext" class="elem-anchor"></a>
<h3>IXmlElementFactoryContext<a href="#ixmlelementfactorycontext" class="anchor-link"><span></span></a></h3>

<!-- Begin IXmlElementFactoryContext -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlElementFactoryContext</span>
<span class="p">{</span>
  <span class="n">T</span> <span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">ITreeNode</span> <span class="n">currentNode</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">returnCurrent</span><span class="p">);</span>
  <span class="n">IXmlTag</span> <span class="nf">GetParentTag</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">currentTag</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a></li>
</ul>

<!-- End IXmlElementFactoryContext -->

<p>Helper methods used while parsing XML into <a href="TreeNodes.html#ixmltreenode"><span><code class="code highlight language-text">IXmlTreeNode</code></span></a> instances. Allows treating a node as though it has a different parent or containing node while parsing.</p>

<a name="r" class="elem-anchor"></a>
<h2>R<a href="#r" class="anchor-link"><span></span></a></h2>

<a name="resyncxmlelementfactory" class="elem-anchor"></a>
<h3>ResyncXmlElementFactory<a href="#resyncxmlelementfactory" class="anchor-link"><span></span></a></h3>

<!-- Begin ResyncXmlElementFactory -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">ResyncXmlElementFactory</span> <span class="p">:</span>
  <span class="n">DelegatingXmlElementFactory</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">ResyncXmlElementFactory</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">xmlTagContainer</span><span class="p">,</span> <span class="n">IXmlElementFactory</span> <span class="n">factory</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateAttribute</span><span class="p">(</span><span class="n">IXmlIdentifier</span> <span class="n">nameIdentifier</span><span class="p">,</span> <span class="n">IXmlAttributeContainer</span> <span class="n">attributeContainer</span><span class="p">,</span> <span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlTag</span> <span class="nf">CreateRootTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlTag</span> <span class="nf">CreateTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlTag</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlTagFooter</span> <span class="nf">CreateTagFooter</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlTagHeader</span> <span class="nf">CreateTagHeader</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="ElementFactories.html#delegatingxmlelementfactory"><span>DelegatingXmlElementFactory</span></a>, <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlattributecontainer"><span>IXmlAttributeContainer</span></a>, <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmlidentifier"><span>IXmlIdentifier</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a>, <a href="TreeNodes.html#ixmltagfooter"><span>IXmlTagFooter</span></a>, <a href="TreeNodes.html#ixmltagheader"><span>IXmlTagHeader</span></a></li>
</ul>

<!-- End ResyncXmlElementFactory -->

<p>Implementation detail for incremental reparsing. When a change is made to a file which is encapsulated by an <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a>, the tag’s <code class="code highlight language-text">IChameleonNode.Resync</code> method is called, and the node tries to reparse just its contents, rather than have to parse the whole file on each change.</p>

<p>The changed range is re-parsed, as a whole file. However, the element factory used by the parser is <a href="#resyncxmlelementfactory"><span><code class="code highlight language-text">ResyncXmlElementFactory</code></span></a>, which is passed the original parent tag in its constructor. When creating tags, headers, footers and attributes where the passed <code class="code highlight language-text">parentTag</code> is the root <a href="TreeNodes.html#ixmlfile"><span><code class="code highlight language-text">IXmlFile</code></span></a>, the <a href="#resyncxmlelementfactory"><span><code class="code highlight language-text">ResyncXmlElementFactory</code></span></a> replaces the <code class="code highlight language-text">parentTag</code> parameter with the original parent tag passed to the constructor. This keeps the context of the original parent tag when parsing the changed child content.</p>

<a name="resyncxmlelementfactorycontext" class="elem-anchor"></a>
<h3>ResyncXmlElementFactoryContext<a href="#resyncxmlelementfactorycontext" class="anchor-link"><span></span></a></h3>

<!-- Begin ResyncXmlElementFactoryContext -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">ResyncXmlElementFactoryContext</span> <span class="p">:</span>
  <span class="n">IXmlElementFactoryContext</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">ResyncXmlElementFactoryContext</span><span class="p">(</span><span class="n">ITreeNode</span> <span class="n">physicalNode</span><span class="p">);</span>

  <span class="k">public</span> <span class="n">T</span> <span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">ITreeNode</span> <span class="n">currentNode</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">returnCurrent</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">GetParentTag</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">currentTag</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a></li>
</ul>

<!-- End ResyncXmlElementFactoryContext -->

<p>Defers to <a href="#defaultxmlelementfactorycontext"><span><code class="code highlight language-text">DefaultXmlElementFactoryContext</code></span></a>. If the returned value is <code class="code highlight language-text">null</code>, the original node passed to the constructor is checked.</p>

<a name="x" class="elem-anchor"></a>
<h2>X<a href="#x" class="anchor-link"><span></span></a></h2>

<a name="xmlelementfactory" class="elem-anchor"></a>
<h3>XmlElementFactory<a href="#xmlelementfactory" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlElementFactory -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">XmlElementFactory</span>
<span class="p">{</span>
  <span class="k">protected</span> <span class="nf">XmlElementFactory</span><span class="p">(</span><span class="n">IPsiModule</span> <span class="n">module</span><span class="p">,</span> <span class="n">IXmlElementFactory</span> <span class="n">factory</span><span class="p">,</span> <span class="n">IXmlLanguageSupport</span> <span class="n">support</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">applyFormatter</span><span class="p">);</span>

  <span class="k">protected</span> <span class="kt">bool</span> <span class="n">ApplyFormatter</span><span class="p">;</span>
  <span class="k">protected</span> <span class="n">IXmlElementFactory</span> <span class="n">Factory</span><span class="p">;</span>
  <span class="k">protected</span> <span class="n">IPsiModule</span> <span class="n">Module</span><span class="p">;</span>
  <span class="k">protected</span> <span class="n">IXmlLanguageSupport</span> <span class="n">Support</span><span class="p">;</span>

  <span class="k">public</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateAttributeForTag</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">contextTag</span><span class="p">,</span> <span class="kt">string</span> <span class="n">attributeText</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlFile</span> <span class="nf">CreateFile</span><span class="p">(</span><span class="kt">string</span> <span class="n">xmlText</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateRootAttribute</span><span class="p">(</span><span class="kt">string</span> <span class="n">attributeText</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">CreateRootTag</span><span class="p">(</span><span class="kt">string</span> <span class="n">tagText</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">CreateTagForTag</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">contextTag</span><span class="p">,</span> <span class="kt">string</span> <span class="n">tagText</span><span class="p">,</span> <span class="kt">string</span> <span class="n">rootTagText</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="n">XmlElementFactory</span> <span class="nf">GetInstance</span><span class="p">(</span><span class="n">ITreeNode</span> <span class="n">context</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">applyFormatter</span> <span class="p">=</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="ElementFactories.html#ixmlelementfactory"><span>IXmlElementFactory</span></a>, <a href="TreeNodes.html#ixmlfile"><span>IXmlFile</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a></li>
</ul>

<!-- End XmlElementFactory -->

<p>Methods for creating instances of <a href="TreeNodes.html#ixmlfile"><span><code class="code highlight language-text">IXmlFile</code></span></a>, <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a> and <a href="#ixmlattribute"><span><code class="code highlight language-text">IXmlAttribute</code></span></a>. It is intended for use by code client. Note that it does not implement the similarly named <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a> interface (in fact, internally, it uses this interface). Clients can get an instance of the class via the <code class="code highlight language-text">GetInstance</code> static method. Passing in an <code class="code highlight language-text">ITreeNode</code> allows for getting the language specific implementations of <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a> and <code class="code highlight language-text">XmlLanguageSupport</code>.</p>

<ul>
  <li><code class="code highlight language-text">CreateFile</code> will parse a string containing XML into a complete XML file, represented by <a href="TreeNodes.html#ixmlfile"><span><code class="code highlight language-text">IXmlFile</code></span></a>.</li>
  <li><code class="code highlight language-text">CreateRootTag</code> creates an instance of <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a> based on the given XML string. It is a “root” tag in that it treats the given string as a complete XML file, and returns the first tag found in that “file”.</li>
  <li><code class="code highlight language-text">CreateRootAttribute</code> creates an instance of <a href="TreeNodes.html#ixmlattribute"><span><code class="code highlight language-text">IXmlAttribute</code></span></a> given an XML string that represents an attribute, e.g. <code class="code highlight language-text">name=&quot;value&quot;</code>. It is a “root” attribute in that the attribute is added to a “root” tag in a parsed file.</li>
  <li><code class="code highlight language-text">CreateTagForTag</code> creates an instance of <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a>, as though it were parsed with a parent tag of <code class="code highlight language-text">contextTag</code>. It does this by creating an instance of the <a href="#xmlelementfactoryforcreatetag"><span><code class="code highlight language-text">XmlElementFactoryForCreateTag</code></span></a> element factory, passing in <code class="code highlight language-text">contextTag</code> (and the language specific implementation of <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a>). When this factory gets called to create a new tag, it substitutes the <code class="code highlight language-text">contextTag</code> as the parent, and passes the call to the inner implementation to create the tag. This allows per-language implementations of <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a> to have more context when creating a tag - it knows the parent tag and can create an appropriate child tag. For example, the XAML implementation of <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a> creates an instance of <code class="code highlight language-text">StaticResourceElement</code> (that implements <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a> if <code class="code highlight language-text">textTag</code> is <code class="code highlight language-text">&lt;x:Static&gt;...&lt;/x:Static&gt;</code> and the parent <code class="code highlight language-text">contextTag</code> is a resource dictionary. The <code class="code highlight language-text">rootTagText</code> parameter is used to create the root tag, if that is required for special processing. Leaving it null will use a sensible default value.</li>
  <li><code class="code highlight language-text">CreateAttributeForTag</code> is similar to <code class="code highlight language-text">CreateTagForTag</code>, except it uses the <a href="#xmlelementfactoryforcreateattribute"><span><code class="code highlight language-text">XmlElementFactoryForCreateAttribute</code></span></a> element factory to use the given <code class="code highlight language-text">contextTag</code> when creating an attribute.</li>
</ul>

<p>Once a node has been created, it can be passed to <code class="code highlight language-text">ModificationUtil</code> to be added to a new tree.</p>

<p>Generally speaking, callers should use <code class="code highlight language-text">CreateTagForTag</code> and <code class="code highlight language-text">CreateTagForAttribute</code> when wishing to create a tag or an attribute. Only use the “root” variants when the tag or attribute actually is at the root level.</p>

<a name="xmlelementfactorylttxmllanguagegt" class="elem-anchor"></a>
<h3>XmlElementFactory&lt;TXmlLanguage&gt;<a href="#xmlelementfactorylttxmllanguagegt" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlElementFactory`1 -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">XmlElementFactory</span><span class="p">&lt;</span><span class="n">TXmlLanguage</span><span class="p">&gt;</span> <span class="p">:</span>
  <span class="n">XmlElementFactory</span>
<span class="p">{</span>
  <span class="k">protected</span> <span class="n">XmlElementFactory</span><span class="p">&lt;</span><span class="n">TXmlLanguage</span><span class="p">&gt;(</span><span class="n">IPsiModule</span> <span class="n">module</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">applyFormatter</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="n">XmlElementFactory</span><span class="p">&lt;</span><span class="n">TXmlLanguage</span><span class="p">&gt;</span> <span class="n">GetInstance</span><span class="p">(</span><span class="n">IPsiModule</span> <span class="n">module</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">applyFormatter</span> <span class="p">=</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="ElementFactories.html#xmlelementfactory"><span>XmlElementFactory</span></a></li>
</ul>

<!-- End XmlElementFactory`1 -->

<p>A derived instance of <a href="#xmlelementfactory"><span><code class="code highlight language-text">XmlElementFactory</code></span></a> which allows creating calling <code class="code highlight language-text">GetInstance</code> for a specific language without requiring an instance of <code class="code highlight language-text">ITreeNode</code>. Also derived by some XML languages to provide additional functionality for the factory, e.g. <code class="code highlight language-text">ResxElementFactory</code> and <code class="code highlight language-text">XamlElementFactory</code>.</p>

<a name="xmlelementfactoryforcreateattribute" class="elem-anchor"></a>
<h3>XmlElementFactoryForCreateAttribute<a href="#xmlelementfactoryforcreateattribute" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlElementFactoryForCreateAttribute -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">XmlElementFactoryForCreateAttribute</span> <span class="p">:</span>
  <span class="n">DelegatingXmlElementFactory</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">XmlElementFactoryForCreateAttribute</span><span class="p">(</span><span class="n">IXmlElementFactory</span> <span class="n">factory</span><span class="p">,</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateAttribute</span><span class="p">(</span><span class="n">IXmlIdentifier</span> <span class="n">nameIdentifier</span><span class="p">,</span> <span class="n">IXmlAttributeContainer</span> <span class="n">attributeContainer</span><span class="p">,</span> <span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="ElementFactories.html#delegatingxmlelementfactory"><span>DelegatingXmlElementFactory</span></a>, <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlattributecontainer"><span>IXmlAttributeContainer</span></a>, <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmlidentifier"><span>IXmlIdentifier</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a></li>
</ul>

<!-- End XmlElementFactoryForCreateAttribute -->

<p>Instance of <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a> that changes the context when creating an attribute to instead of using the passed in <code class="code highlight language-text">parentTag</code> as the parent tag of the newly created attribute, uses an instance of <code class="code highlight language-text">IXmlTag</code> passed to the constructor. This is used as an implementation detail of <a href="#xmlelementfactory"><span><code class="code highlight language-text">XmlElementFactory.CreateAttributeForTag()</code></span></a> to make sure the new attribute is created with the correct parent tag as context. See <a href="#xmlelementfactory"><span><code class="code highlight language-text">XmlElementFactory</code></span></a> for more details.</p>

<a name="xmlelementfactoryforcreatetag" class="elem-anchor"></a>
<h3>XmlElementFactoryForCreateTag<a href="#xmlelementfactoryforcreatetag" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlElementFactoryForCreateTag -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">XmlElementFactoryForCreateTag</span> <span class="p">:</span>
  <span class="n">DelegatingXmlElementFactory</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">XmlElementFactoryForCreateTag</span><span class="p">(</span><span class="n">IXmlElementFactory</span> <span class="n">factory</span><span class="p">,</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateAttribute</span><span class="p">(</span><span class="n">IXmlIdentifier</span> <span class="n">nameIdentifier</span><span class="p">,</span> <span class="n">IXmlAttributeContainer</span> <span class="n">attributeContainer</span><span class="p">,</span> <span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">override</span> <span class="n">IXmlTag</span> <span class="nf">CreateTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlTag</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="ElementFactories.html#delegatingxmlelementfactory"><span>DelegatingXmlElementFactory</span></a>, <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlattributecontainer"><span>IXmlAttributeContainer</span></a>, <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmlidentifier"><span>IXmlIdentifier</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a>, <a href="TreeNodes.html#ixmltagheader"><span>IXmlTagHeader</span></a></li>
</ul>

<!-- End XmlElementFactoryForCreateTag -->

<p>Instance of <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a> that changes the context when creating a tag to ignore the passed <code class="code highlight language-text">parentTag</code> when creating the tree node, and use the tag passed to the constructor as the parent instead. This class is used as an implementation detail of <a href="#xmlelementfactory"><span><code class="code highlight language-text">XmlElementFactory.CreateTagForTag()</code></span></a> to make sure the new attribute is created with the correct parent tag as context. See <a href="#xmlelementfactory"><span><code class="code highlight language-text">XmlElementFactory</code></span></a> for more details.</p>

<a name="xmltreenodefactory" class="elem-anchor"></a>
<h3>XmlTreeNodeFactory<a href="#xmltreenodefactory" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlTreeNodeFactory -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[Language(typeof(XmlLanguage))]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">XmlTreeNodeFactory</span> <span class="p">:</span>
  <span class="n">IXmlElementFactory</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">XmlTreeNodeFactory</span><span class="p">(</span><span class="n">XmlLanguage</span> <span class="n">languageType</span><span class="p">,</span> <span class="n">XmlTokenTypes</span> <span class="n">tokenTypes</span><span class="p">,</span> <span class="n">XmlElementTypes</span> <span class="n">elementTypes</span><span class="p">);</span>

  <span class="n">PsiLanguageType</span> <span class="n">LanguageType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">XmlElementTypes</span> <span class="n">XmlElementType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">XmlTokenTypes</span> <span class="n">XmlTokenTypes</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

  <span class="k">public</span> <span class="n">IAnyContent</span> <span class="nf">CreateAnyContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IAttDef</span> <span class="nf">CreateAttDef</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateAttribute</span><span class="p">(</span><span class="n">IXmlIdentifier</span> <span class="n">nameIdentifier</span><span class="p">,</span> <span class="n">IXmlAttributeContainer</span> <span class="n">attributeContainer</span><span class="p">,</span> <span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlAttributeValue</span> <span class="nf">CreateAttributeValue</span><span class="p">(</span><span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IAttType</span> <span class="nf">CreateAttType</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlCData</span> <span class="nf">CreateCData</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlComment</span> <span class="nf">CreateComment</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDocTypeDeclaration</span> <span class="nf">CreateDocTypeDeclaration</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDAttListDecl</span> <span class="nf">CreateDTDAttListDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDElementDecl</span> <span class="nf">CreateDTDElementDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDEntityDecl</span> <span class="nf">CreateDTDEntityDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDNotationDecl</span> <span class="nf">CreateDTDNotationDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IEmptyContent</span> <span class="nf">CreateEmptyContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlSyntaxErrorElement</span> <span class="nf">CreateError</span><span class="p">(</span><span class="n">XmlSyntaxErrorType</span> <span class="n">errorType</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlFile</span> <span class="nf">CreateFile</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IGrouppedContent</span> <span class="nf">CreateGrouppedContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlIdentifier</span> <span class="nf">CreateIdentifier</span><span class="p">(</span><span class="n">ITokenIntern</span> <span class="n">internalizer</span><span class="p">,</span> <span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IDTDBody</span> <span class="nf">CreateIntSubset</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IDTDNDataDecl</span> <span class="nf">CreateNDataDecl</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IProcessingInstruction</span> <span class="nf">CreatePI</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlProcessingInstruction</span> <span class="nf">CreatePIXml</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IExternalId</span> <span class="nf">CreatePublicExternalID</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IRepetitionContent</span> <span class="nf">CreateRepetionContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">CreateRootTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IElementContent</span> <span class="nf">CreateSimpleContent</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IExternalId</span> <span class="nf">CreateSystemExternalID</span><span class="p">();</span>
  <span class="k">public</span> <span class="n">IXmlTag</span> <span class="nf">CreateTag</span><span class="p">(</span><span class="n">IXmlTagHeader</span> <span class="n">header</span><span class="p">,</span> <span class="n">IXmlTag</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTagFooter</span> <span class="nf">CreateTagFooter</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlTagHeader</span> <span class="nf">CreateTagHeader</span><span class="p">(</span><span class="n">IXmlTagContainer</span> <span class="n">parentTag</span><span class="p">,</span> <span class="n">IXmlElementFactoryContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="n">IXmlToken</span> <span class="nf">CreateToken</span><span class="p">(</span><span class="n">ITokenIntern</span> <span class="n">internalizer</span><span class="p">,</span> <span class="n">XmlTokenNodeType</span> <span class="n">tokenType</span><span class="p">,</span> <span class="n">IBuffer</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startOffset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endOffset</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlElementFactory</span> <span class="n">GetInstance</span><span class="p">&lt;</span><span class="n">TLanguage</span><span class="p">&gt;();</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlElementFactory</span> <span class="nf">GetInstance</span><span class="p">(</span><span class="n">ITreeNode</span> <span class="n">element</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodesDTD.html#ianycontent"><span>IAnyContent</span></a>, <a href="TreeNodesDTD.html#iattdef"><span>IAttDef</span></a>, <a href="TreeNodesDTD.html#iatttype"><span>IAttType</span></a>, <a href="TreeNodesDTD.html#idoctypedeclaration"><span>IDocTypeDeclaration</span></a>, <a href="TreeNodesDTD.html#idtdattlistdecl"><span>IDTDAttListDecl</span></a>, <a href="TreeNodesDTD.html#idtdbody"><span>IDTDBody</span></a>, <a href="TreeNodesDTD.html#idtdelementdecl"><span>IDTDElementDecl</span></a>, <a href="TreeNodesDTD.html#idtdentitydecl"><span>IDTDEntityDecl</span></a>, <a href="TreeNodesDTD.html#idtdndatadecl"><span>IDTDNDataDecl</span></a>, <a href="TreeNodesDTD.html#idtdnotationdecl"><span>IDTDNotationDecl</span></a>, <a href="TreeNodesDTD.html#ielementcontent"><span>IElementContent</span></a>, <a href="TreeNodesDTD.html#iemptycontent"><span>IEmptyContent</span></a>, <a href="TreeNodesDTD.html#iexternalid"><span>IExternalId</span></a>, <a href="TreeNodesDTD.html#igrouppedcontent"><span>IGrouppedContent</span></a>, <a href="TreeNodes.html#iprocessinginstruction"><span>IProcessingInstruction</span></a>, <a href="TreeNodesDTD.html#irepetitioncontent"><span>IRepetitionContent</span></a>, <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlattributecontainer"><span>IXmlAttributeContainer</span></a>, <a href="TreeNodes.html#ixmlattributevalue"><span>IXmlAttributeValue</span></a>, <a href="TreeNodes.html#ixmlcdata"><span>IXmlCData</span></a>, <a href="TreeNodes.html#ixmlcomment"><span>IXmlComment</span></a>, <a href="ElementFactories.html#ixmlelementfactory"><span>IXmlElementFactory</span></a>, <a href="ElementFactories.html#ixmlelementfactorycontext"><span>IXmlElementFactoryContext</span></a>, <a href="TreeNodes.html#ixmlfile"><span>IXmlFile</span></a>, <a href="TreeNodes.html#ixmlidentifier"><span>IXmlIdentifier</span></a>, <a href="TreeNodes.html#ixmlprocessinginstruction"><span>IXmlProcessingInstruction</span></a>, <a href="TreeNodes.html#ixmlsyntaxerrorelement"><span>IXmlSyntaxErrorElement</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a>, <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a>, <a href="TreeNodes.html#ixmltagfooter"><span>IXmlTagFooter</span></a>, <a href="TreeNodes.html#ixmltagheader"><span>IXmlTagHeader</span></a>, <a href="TreeNodes.html#ixmltoken"><span>IXmlToken</span></a></li>
</ul>

<!-- End XmlTreeNodeFactory -->

<p>Default implementation of <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a>. This is used by the parser and lexer to create <a href="TreeNode.html#ixmltreenode"><span><code class="code highlight language-text">IXmlTreeNode</code></span></a> instances when building the PSI tree. It is a per-language class, as indicated by the <code class="code highlight language-text">[Language(typeof(XmlLanguage))]</code> attribute. This means it will be used for all XML derived languages when calling <code class="code highlight language-text">LanguageManager.Instance.GetService&lt;IXmlElementFactory&gt;(language)</code>, unless the derived language implements its own <a href="#ixmlelementfactory"><span><code class="code highlight language-text">IXmlElementFactory</code></span></a>.</p>

<p>Call one of the <code class="code highlight language-text">GetInstance</code> methods to get an instance of the class (internally, this calls <code class="code highlight language-text">LanguageManager.GetService</code>, using the language from the passed in <code class="code highlight language-text">ITreeNode</code> or the <code class="code highlight language-text">TLanguage</code> generic parameter.</p>

<p>Use this class to create low-level tree nodes. Use the [<code class="code highlight language-text">XmlElementFactory</code>] class to create a whole <a href="TreeNodes.html#ixmlfile"><span><code class="code highlight language-text">IXmlFile</code></span></a> or tags and attributes.</p>


                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper-devguide/app/js/main.build" data-baseurl="/resharper-devguide/" src="/resharper-devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

