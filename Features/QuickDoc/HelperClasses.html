


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper/devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper/devguide/styles/styles.css"></head>
<body data-id="Features/QuickDoc/HelperClasses">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="presenter-helper-classes" class="elem-anchor"></a>
<h1>Presenter helper classes<a href="#presenter-helper-classes" class="anchor-link"><span></span></a></h1>

<p>ReSharper provides a couple of classes to help build the HTML - <strong><code class="code highlight language-text">XmlDocHtmlUtil</code></strong> and <strong><code class="code highlight language-text">XmlDocHtmlPresenter</code></strong>. Typically, the presenter will generate the HTML by calling <code class="code highlight language-text">XmlDocHtmlPresenter.Run</code> which in turn calls methods on <code class="code highlight language-text">XmlDocHtmlUtil</code>, such as <code class="code highlight language-text">XmlDocHtmlUtil.BuildHtml</code>, although the presenter is free to call <code class="code highlight language-text">XmlDocHtmlUtil</code> directly, or create the HTML itself. It is, however, recommended to use the helper classes).</p>

<a name="xmldochtmlutil" class="elem-anchor"></a>
<h3>XmlDocHtmlUtil<a href="#xmldochtmlutil" class="anchor-link"><span></span></a></h3>

<p>Since the presenter has to create the entire HTML that is displayed, it should at the very least use the standard HTML style template that is defined as a public constant in <code class="code highlight language-text">XmlDocHtmlUtil.QUICK_DOC_HTML_STYLE</code>:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">return</span> <span class="s">&quot;&lt;html&gt;&lt;head&gt;\n&quot;</span> <span class="p">+</span>
  <span class="s">&quot;&lt;META http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=utf-8\&quot;&gt;\n&quot;</span> <span class="p">+</span>
  <span class="n">XmlDocHtmlUtil</span><span class="p">.</span><span class="n">QUICK_DOC_HTML_STYLE</span> <span class="p">+</span>
  <span class="s">&quot;  &lt;/head&gt;&lt;body&gt;\n&quot;</span> <span class="p">+</span>
  <span class="n">body</span> <span class="p">+</span>
  <span class="s">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">;</span></code></pre>

<p>However, doing this doesn’t include the standard scripts for showing and hiding sections, or the content for the “go to” and “read more” links. To get this, call <code class="code highlight language-text">XmlDocHtmlUtil.BuildHtml</code>, passing in a function that will insert the HTML body into a given <code class="code highlight language-text">StringBuilder</code>, and also a <code class="code highlight language-text">NavigationStyle</code> enum to state if you want “go to”, “read more”, both or none:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="n">BuildHtml</span><span class="p">(</span><span class="n">sb</span> <span class="p">=&gt;</span> <span class="n">sb</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">body</span><span class="p">),</span> <span class="n">NavigationStyle</span><span class="p">.</span><span class="n">All</span><span class="p">);</span></code></pre>

<p>There are a number of other helper methods:</p>

<ul>
  <li>
    <p><code class="code highlight language-text">Hyperlink</code> adds an <code class="code highlight language-text">&lt;a&gt;</code> tag to link to the passed in code element ID (not just XML Doc Comment ID - this ID is passed to <code class="code highlight language-text">IQuickDocPresenter.Resolve</code> when the link is clicked). The hyperlink is created in the form <code class="code highlight language-text">cref:ID</code>, which explains the mention of <code class="code highlight language-text">cref</code> elsewhere in the API.</p>

    <p>There are two overloads, one take a simple tooltip parameter, which is frequently set to the fully qualified typename of the code element, and the other takes a class whose properties are used to add attributes to the <code class="code highlight language-text">&lt;a&gt;</code> tag.</p>

    <p>This can be used with anonymous types. For example, CLR attributes get the “ext” class added to indicate external annotation attributes:</p>

    <p><code class="code highlight language-text">csharp
  var htmlFragment = Hyperlink(name, id, new {
    @class = &quot;ext&quot;,
    title = fullyQualifiedName
  });</code></p>
  </li>
  <li><code class="code highlight language-text">ProcessCRef</code> will also create a hyperlink, by calling <code class="code highlight language-text">Hyperlink</code>. It will use the <code class="code highlight language-text">linktext</code> parameter passed in as the text, if available. If not, it will try to use the <code class="code highlight language-text">cref</code> parameter as an XML Doc Comment ID to resolve a CLR <code class="code highlight language-text">IDeclaredElement</code>, and use the name as the link text and fully qualified name as a tooltip. Failing that, it strips any colon-delimited prefix (e.g. “M:”) from the <code class="code highlight language-text">cref</code> parameter to use as the link text.</li>
  <li><code class="code highlight language-text">OpenCollapsedRegion</code> creates a new region (by inserting a <code class="code highlight language-text">&lt;div&gt;</code>) that is collapsed by default. More content can be added to the <code class="code highlight language-text">StringBuilder</code> to populate the region, and <code class="code highlight language-text">CloseCollapsedRegion</code> will close the <code class="code highlight language-text">div</code>. It is used to include collapsed region in the documentation summary.</li>
  <li><code class="code highlight language-text">OpenAttributesRegion</code>/<code class="code highlight language-text">CloseAttributesRegion</code> is very similar to <code class="code highlight language-text">OpenCollapsedRegion</code>/<code class="code highlight language-text">CloseCollapsedRegion</code> except it has different styling, and shows up in the top left of the QuickDoc window. It is used to show the attributes for CLR types and type members.</li>
</ul>

<a name="xmldochtmlpresenter" class="elem-anchor"></a>
<h3>XmlDocHtmlPresenter<a href="#xmldochtmlpresenter" class="anchor-link"><span></span></a></h3>

<p><code class="code highlight language-text">XmlDocHtmlPresenter</code> is a higher-level API for generating HTML QuickDoc content. It expects an XML node based on the CLR XML Doc Comment format. However, the API is not restricted to CLR XML Doc Comments. The XML is used to create structured HTML, and can be used to generate JavaScript function or CSS type property documentation just as easily as C# type member documentation. Several of the default providers create a new xml node in order to generate documentation.</p>

<p>The entry point to the API is the <code class="code highlight language-text">Run</code> method:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="kt">var</span> <span class="n">html</span> <span class="p">=</span> <span class="n">XmlDocHtmlPresenter</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">navigationStyle</span><span class="p">,</span> <span class="n">processCRef</span><span class="p">);</span></code></pre>

<p>The parameters are:</p>

<ul>
  <li><code class="code highlight language-text">node</code> - the XML node representing the documentation.</li>
  <li><code class="code highlight language-text">module</code> - an instance of <code class="code highlight language-text">IPsiModule</code> that is passed through untouched to the <code class="code highlight language-text">processCRef</code> delegate.</li>
  <li><code class="code highlight language-text">element</code> - the <code class="code highlight language-text">IDeclaredElement</code> instance that the documentation is for. If specified, it’s used to create the code element name header information. If null or empty, the name of the code element comes from the XML node.</li>
  <li><code class="code highlight language-text">language</code> - the <code class="code highlight language-text">PsiLanguageType</code> used to format the <code class="code highlight language-text">IDeclaredElement</code> name.</li>
  <li><code class="code highlight language-text">navigationStyle</code> - “go to”, “read more”, both or none</li>
  <li><code class="code highlight language-text">processCRef</code> - a delegate to handle what happens when references to other code elements should be rendered. Usually defers to <code class="code highlight language-text">XmlDocHtmlUtil.ProcessCRef</code> to create a hyperlink.</li>
</ul>

<p><code class="code highlight language-text">Run</code> calls <code class="code highlight language-text">XmlDocHtmlUtil.BuildHtml</code> to create the skeleton HTML, and provides its own implementation of the <code class="code highlight language-text">appendTextBody</code> delegate to populate the HTML body content. This implementation processes the XML node, and formats the HTML appropriately.</p>

<a name="xml-node-format" class="elem-anchor"></a>
<h4>XML node format</h4>

<p>The <code class="code highlight language-text">Run</code> methods understands the standard CLR XML Doc Comment format, and can also handle unknown elements.</p>

<p>Generally, the root node is the <code class="code highlight language-text">member</code> node, and is used to generate a name heading for the documentation.</p>

<p>All child nodes of the <code class="code highlight language-text">member</code> node are converted into sections in the generated HTML. Each section has a title, such as “Remarks” or “See Also”, and the content of each XML node is converted and displayed in the section.</p>

<aside class="note">
  <p> the root node of the XML will only be processed if an <code class="code highlight language-text">IDeclaredElement</code> is passed in, otherwise the child nodes are immediately processed instead. While it is assumed that the root node is the <code class="code highlight language-text">member</code> node, this is not a requirement.</p>
</aside>

<p>The following elements are recognised:</p>

<ul>
  <li>
    <p><code class="code highlight language-text">member</code> - if an <code class="code highlight language-text">IDeclaredElement</code> is specified, the per-language <code class="code highlight language-text">IXmlDocHeaderPresenter</code> interface is used to format the name of the <code class="code highlight language-text">IDeclaredElement</code>. If no element is passed in, the <code class="code highlight language-text">name</code> attribute of the <code class="code highlight language-text">member</code> tag is passed to the <code class="code highlight language-text">processCRef</code> delegate (which typically defers to <code class="code highlight language-text">XmlDocHtmlUtil.ProcessCRef</code>, which creates a hyperlink in the form <code class="code highlight language-text">cref:id</code>). As such, the <code class="code highlight language-text">name</code> attribute should be the CLR XML Doc Comment ID of the element, or a similar ID understood by the QuickDoc presenter.</p>

    <p>After processing the <code class="code highlight language-text">member</code> name, the node’s children are processed, and converted into top level “sections” in the HTML document.</p>
  </li>
  <li><code class="code highlight language-text">include</code> will include the content of another file.
    <ul>
      <li>The <code class="code highlight language-text">file</code> attribute provides either the fully qualified path name of the file, or a filename relative to the source file containing the declaration of the <code class="code highlight language-text">IDeclaredElement</code>.</li>
      <li>Once the file has been read, the <code class="code highlight language-text">path</code> attribute is used as an XPath statement to retrieve XML nodes which are in turn processed into HTML</li>
    </ul>
  </li>
  <li><code class="code highlight language-text">example</code>, <code class="code highlight language-text">summary</code>, <code class="code highlight language-text">value</code>, <code class="code highlight language-text">remarks</code>, and <code class="code highlight language-text">return</code> are simply converted into top level HTML sections, with their child nodes processed as content.</li>
  <li><code class="code highlight language-text">exception</code> and <code class="code highlight language-text">permission</code> are formatted as a table in the HTML, with the child nodes providing the content, and the <code class="code highlight language-text">cref</code> attribute formatted into a hyperlink with the <code class="code highlight language-text">processCRef</code> delegate. The <code class="code highlight language-text">cref</code> attribute should be an ID understood by the presenter.</li>
  <li><code class="code highlight language-text">param</code> and <code class="code highlight language-text">typeparam</code> are also formatted into a HTML table, but the <code class="code highlight language-text">name</code> attribute is passed to <code class="code highlight language-text">processCRef</code> for the name.</li>
  <li><code class="code highlight language-text">br</code> inserts a <code class="code highlight language-text">&lt;br&gt;</code> HTML element.</li>
  <li><code class="code highlight language-text">c</code> inserts the content of the XML node verbatim into a <code class="code highlight language-text">&lt;code&gt;</code> HTML block. The inner text of the XML node is escaped with <code class="code highlight language-text">XmlDocPresenterUtil.EscapeHtmlString</code> first</li>
  <li><code class="code highlight language-text">code</code> also inserts the content of the XML node as a pre-formatted <code class="code highlight language-text">&lt;pre&gt;</code> element. Some cleansing is applied to the pre-formatted text, to normalise indenting, newlines and escape HTML strings.</li>
  <li><code class="code highlight language-text">para</code> processes its child nodes, and wraps the resulting content in a <code class="code highlight language-text">&lt;p&gt;</code> element.</li>
  <li><code class="code highlight language-text">paramref</code> and <code class="code highlight language-text">typeparamref</code> format the <code class="code highlight language-text">name</code> attribute in a HTML <code class="code highlight language-text">&lt;var&gt;</code> element.</li>
  <li><code class="code highlight language-text">seealso</code> passes the <code class="code highlight language-text">cref</code> attribute to <code class="code highlight language-text">processCRef</code>, and the resulting hyperlink is added to the HTML. <code class="code highlight language-text">cref</code> should be an ID understood by the presenter.</li>
  <li><code class="code highlight language-text">see</code> also passes the <code class="code highlight language-text">cref</code> attribute to <code class="code highlight language-text">processCRef</code> and appends the output hyperlink. It also supports the <code class="code highlight language-text">langword</code> and <code class="code highlight language-text">title</code> attributes.</li>
  <li><code class="code highlight language-text">list</code> looks for the <code class="code highlight language-text">type</code> attribute to see what kind of list is to be created. Accepted values are <code class="code highlight language-text">bullet</code> and <code class="code highlight language-text">number</code>. If no value is specified, the list is formatted as a table.
    <ul>
      <li>if the <code class="code highlight language-text">listheader</code> child element is specified, its <code class="code highlight language-text">term</code> and <code class="code highlight language-text">description</code> elements are processed (to handle links, code or <code class="code highlight language-text">seealso</code>, etc.) and added to a <code class="code highlight language-text">&lt;tr&gt;</code>, <code class="code highlight language-text">&lt;ul&gt;</code> or <code class="code highlight language-text">&lt;ol&gt;</code> element, depending on the type of the list.</li>
      <li>Each <code class="code highlight language-text">item</code> node’s <code class="code highlight language-text">term</code> and <code class="code highlight language-text">description</code> elements are added to the list, as either <code class="code highlight language-text">&lt;tr&gt;</code> or <code class="code highlight language-text">&lt;li&gt;</code> elements.</li>
    </ul>
  </li>
</ul>

<p>If a top-level element (i.e. a direct child of the root node, or the <code class="code highlight language-text">member</code> node) is not one of the elements in the above list, a new section is created for it. The element name is capitalised to make a section name, and the child nodes of the element are processed as above. This means an unknown element can contain known elements such as <code class="code highlight language-text">code</code> and <code class="code highlight language-text">seealso</code>.</p>

<p>If the unknown element is not top-level, then the XML is added to the text of the description. It is not rendered as HTML, but as plain text, with all tags and attributes being encoded to display as-is.</p>

<a name="ixmldocheaderpresenter" class="elem-anchor"></a>
<h4><code class="code highlight language-text">IXmlDocHeaderPresenter</code></h4>

<p>If an <code class="code highlight language-text">IDeclaredElement</code> is passed in, and the member header is to be rendered, the rendering is deferred to a per-language implementation of <code class="code highlight language-text">IXmlDocHeaderPresenter</code>. ReSharper provides per-language implementations for C#, VB and CSS. All other languages share the <code class="code highlight language-text">CommonXmlDocHeaderPresenter</code>.</p>

<p>If you are implementing your own language, and you do not wish to use the <code class="code highlight language-text">CommonXmlDocHeaderPresenter</code>, you should also implement <code class="code highlight language-text">IXmlDocHeaderPresenter</code>. The interface is simple:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IXmlDocHeaderPresenter</span>
<span class="p">{</span>
  <span class="k">void</span> <span class="nf">Present</span><span class="p">(</span><span class="n">StringBuilder</span> <span class="n">header</span><span class="p">,</span> <span class="n">IDeclaredElement</span> <span class="n">declaredElement</span><span class="p">,</span> <span class="n">IPsiModule</span> <span class="n">module</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<p>Calling <code class="code highlight language-text">Present</code> will format the <code class="code highlight language-text">declaredElement</code> into the given <code class="code highlight language-text">StringBuilder</code>.</p>

<p>The default implementation in <code class="code highlight language-text">CommonXmlDocHeaderPresenter</code> will use <code class="code highlight language-text">DeclaredElementPresenter.Format</code> to format the name (this defers to the language’s <code class="code highlight language-text">IDeclaredElementPresnter</code>, another extension point for implementing your own language). It then wraps the name in <code class="code highlight language-text">&lt;dl&gt;</code> and <code class="code highlight language-text">&lt;dt&gt;</code> HTML tags.</p>

<p>The C# implementation overrides this default, and while it too calls <code class="code highlight language-text">DeclaredElementPresenter.Format</code>, it also adds formatting for type parameters, method parameters and attributes on the type, type member or parameters, as well as annotations for where the element is declared (“in class”, “in assembly”, etc.)</p>

<p>If you wish to implement support for your own language that uses CLR attributes, you can provide a per-language implementation of <code class="code highlight language-text">IHtmlAttribtuePresenter</code>, and use the <code class="code highlight language-text">HtmlAttributesPresenterBase</code> class to provide a standard formatting of CLR attributes that are initially hidden and expand only when the user clicks on them.</p>


                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper/devguide/app/js/main.build" data-baseurl="/resharper/devguide/" src="/resharper/devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

