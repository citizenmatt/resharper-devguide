


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper-devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper-devguide/styles/styles.css"></head>
<body data-id="Features/LiveTemplates/Scopes">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="scopes" class="elem-anchor"></a>
<h1>Scopes<a href="#scopes" class="anchor-link"><span></span></a></h1>

<p>ReSharper’s Live Templates can declare the <em>scope</em> in which they are available. That is, instead of allowing all templates to be inserted at any location in any file, a template can be constrained to certain file types, and even to certain locations within those files. For example, a template can be constrained not just to C# files, but to any location where a namespace declaration, type definition, or an expression is valid.</p>

<p>Furthermore, the template scope can be parameterised. For example, a C# template can state that it is only available in C# 3.0 files (perhaps the template wants to make use of LINQ), or in files that match a specific file pattern (e.g. “actions.xml”, “*.html”, etc.)</p>

<p>A template can have multiple scope points, in which case, the template is available if any of the scope points match the current context.</p>

<!-- TODO: Add image for the scope UI -->

<p>In this way, templates can be constrained to be more targeted and useful, even allowing multiple templates with the same shortcut, as long as they are valid in different scopes.</p>

<a name="implementing-a-custom-scope-provider" class="elem-anchor"></a>
<h2>Implementing a custom scope provider<a href="#implementing-a-custom-scope-provider" class="anchor-link"><span></span></a></h2>

<p>The <code class="code highlight language-text">TemplateScopeManager</code> shell component is the main entry point for working with scope points, and it maintains a list of <code class="code highlight language-text">IScopeProvider</code> shell components. As such, it can be extended by a class implementing <code class="code highlight language-text">IScopeProvider</code> and decorated with the <code class="code highlight language-text">[ShellComponent]</code> attribute.</p>

<aside class="note">
  <p> The list of <code class="code highlight language-text">IScopeProvider</code> components maintained by the <code class="code highlight language-text">TemplateScopeManager</code> is injected as an <code class="code highlight language-text">IEnumerable&lt;IScopeProvider&gt;</code> rather than an <code class="code highlight language-text">IViewable&lt;IScopeProvider&gt;</code>. Therefore, the list does not update when new components are made available. Live loading of plugins is not supported; when a new plugin is installed, ReSharper must be restarted before the new scope provider is used.</p>
</aside>

<p>The <code class="code highlight language-text">IScopeProvider</code> interface declares three methods that are used to create scope points:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IScopeProvider</span>
<span class="p">{</span>
  <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ITemplateScopePoint</span><span class="p">&gt;</span> <span class="n">ProvideScopePoints</span><span class="p">(</span><span class="n">TemplateAcceptanceContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="n">ITemplateScopePoint</span> <span class="nf">ReadFromXml</span><span class="p">([</span><span class="n">NotNull</span><span class="p">]</span> <span class="n">XmlElement</span> <span class="n">scopeElement</span><span class="p">);</span>
  <span class="n">ITemplateScopePoint</span> <span class="nf">CreateScope</span><span class="p">(</span><span class="n">Guid</span> <span class="n">scopeGuid</span><span class="p">,</span> <span class="kt">string</span> <span class="n">typeName</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Pair</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">customProperties</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li><strong><code class="code highlight language-text">ProvideScopePoints</code></strong> - returns all scope points that are valid at the context described by the given <code class="code highlight language-text">TemplateAcceptanceContext</code> instance, which provides details about file and text caret position. Parameterised scope points are either set to a reasonable value (for example, C# scope points can set a language version of 3.0 when the current context is in a LINQ query), or replaced by a scope point that makes more sense for the current context (instead of creating a file mask scope point of “*.*”, a project file scope point is returned. This scope point knows how to compare itself against a file mask scope point used in a template)</li>
  <li>
    <p><strong><code class="code highlight language-text">ReadFromXml</code></strong> - used to read a scope point from an XML file. This is not typically used any more, as recent versions of ReSharper store and export templates in <code class="code highlight language-text">.dotSettings</code> format, rather than the proprietary XML read by this method. However, the built-in providers still support this, in order to upgrade existing files in the old format. The complement to this method is the <code class="code highlight language-text">ITemplateScopePoint.WriteToXml</code> method, which is still supported, but no longer exposed by ReSharper.</p>

    <p>The <code class="code highlight language-text">ScopeProvider</code> abstract base class used by all of the built-in providers will create a new instance based on the short type name in the <code class="code highlight language-text">type</code> attribute of the XML element. Deriving classes should call the base method to create the instance, then populate it based on other attributes or child elements of the given XML element.</p>
  </li>
  <li>
    <p><strong><code class="code highlight language-text">CreateScope</code></strong> should create an instance of <code class="code highlight language-text">ITemplateScopePoint</code> based on the given short type name. It receives a GUID identifier that is unique for each template scope point instance (remember, scope points might be parameterised) and custom properties as string name/value pairs. This method is used to read the scope point from a <code class="code highlight language-text">.dotSettings</code> file, which stores all information as name/value pairs.</p>

    <p>Again, the <code class="code highlight language-text">ScopeProvider</code> abstract base class will create a new instance based on the given type name and populate the <code class="code highlight language-text">ITemplateScopePoint.UID</code> with the unique ID. Derived classes should call the base class and populate the new instance based on the custom properties.</p>
  </li>
</ul>

<p>The <code class="code highlight language-text">ScopeProvider</code> abstract base class provides a mechanism for creating specific instances of <code class="code highlight language-text">ITemplateScopePoint</code> based on a given type name. While it can simply instantiate the type based on the type name, it defers to a list of creator functions that take in the type name and create the scope point instance. This provides an extension point for custom creation, while also making it easy to create simple instances.</p>

<p>For example, the CSS scope provider will set up a list of creator functions that simply defer to <code class="code highlight language-text">ScopeProvider.TryToCreate&lt;T&gt;</code> which will create the type if the type name matches:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">CssScopeProvider</span> <span class="p">:</span> <span class="n">ScopeProvider</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">CssScopeProvider</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="n">Creators</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">ITemplateScopePoint</span><span class="p">&gt;&gt;</span>
    <span class="p">{</span>
      <span class="n">s</span> <span class="p">=&gt;</span> <span class="n">TryToCreate</span><span class="p">&lt;</span><span class="n">InCssFile</span><span class="p">&gt;(</span><span class="n">s</span><span class="p">),</span>
      <span class="n">s</span> <span class="p">=&gt;</span> <span class="n">TryToCreate</span><span class="p">&lt;</span><span class="n">InCssExpression</span><span class="p">&gt;(</span><span class="n">s</span><span class="p">),</span>
      <span class="n">s</span> <span class="p">=&gt;</span> <span class="n">TryToCreate</span><span class="p">&lt;</span><span class="n">InCssStatement</span><span class="p">&gt;(</span><span class="n">s</span><span class="p">),</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// ...</span>
<span class="p">}</span></code></pre>

<a name="example-iscopeproviderprovidescopepoints-implementation" class="elem-anchor"></a>
<h3>Example IScopeProvider.ProvideScopePoints implementation<a href="#example-iscopeproviderprovidescopepoints-implementation" class="anchor-link"><span></span></a></h3>

<p>The following is an example of an implementation of <code class="code highlight language-text">IScopeProvider.ProvideScopePoints</code> for CSS files. It examines the current context, as provided by <code class="code highlight language-text">TemplateAcceptanceContext</code> and returns scope points that are valid:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">override</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ITemplateScopePoint</span><span class="p">&gt;</span> <span class="n">ProvideScopePoints</span><span class="p">(</span><span class="n">TemplateAcceptanceContext</span> <span class="n">context</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Ensure we have an IPsiSourceFile, a valid document range, and the file is a CSS file</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">SourceFile</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
    <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>

  <span class="kt">var</span> <span class="n">documentRange</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DocumentRange</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Document</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">CaretOffset</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(!</span><span class="n">documentRange</span><span class="p">.</span><span class="n">IsValid</span><span class="p">())</span>
    <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>

  <span class="kt">var</span> <span class="n">file</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">SourceFile</span><span class="p">.</span><span class="n">GetPsiFile</span><span class="p">&lt;</span><span class="n">CssLanguage</span><span class="p">&gt;(</span><span class="n">documentRange</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
    <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>

  <span class="c1">// Get the prefix at the text caret. This is treated as the shortcut that invokes the template</span>
  <span class="c1">// Then get the AST element that represents the prefix</span>
  <span class="kt">var</span> <span class="n">prefix</span> <span class="p">=</span> <span class="n">LiveTemplatesManager</span><span class="p">.</span><span class="n">GetPrefix</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Document</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">CaretOffset</span><span class="p">);</span>
  <span class="kt">var</span> <span class="n">element</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">FindTokenAt</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Document</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">CaretOffset</span> <span class="p">-</span> <span class="n">prefix</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="k">as</span> <span class="n">ITokenNode</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">element</span> <span class="p">==</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">String</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">prefix</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Document</span><span class="p">.</span><span class="n">GetTextLength</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// There is no element at the caret, no known prefix and the document is empty</span>
      <span class="c1">// Valid scope points are anywhere in a CSS file, and anywhere a CSS statement is valid</span>
      <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">InCssFile</span><span class="p">();</span>
      <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">InCssStatement</span><span class="p">();</span>
      <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// If the caret is at the end of the file, get the token just before the EOF</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Document</span><span class="p">.</span><span class="n">GetTextLength</span><span class="p">()</span> <span class="p">==</span> <span class="n">context</span><span class="p">.</span><span class="n">CaretOffset</span><span class="p">)</span>
      <span class="n">element</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">FindTokenAt</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Document</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">CaretOffset</span> <span class="p">-</span> <span class="m">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">ITokenNode</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// There is no token, so no valid scope points</span>
  <span class="k">if</span><span class="p">(</span><span class="n">element</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
    <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>

  <span class="kt">var</span> <span class="n">treeOffset</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">Translate</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Document</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">CaretOffset</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(!</span><span class="n">treeOffset</span><span class="p">.</span><span class="n">IsValid</span><span class="p">())</span>
    <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>

  <span class="c1">// Return a valid CSS file scope point</span>
  <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">InCssFile</span><span class="p">();</span>

  <span class="c1">// Look at the containing node, and return either a CSS expression or CSS statement scope point</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">ICssPropertyValue</span><span class="p">&gt;(</span><span class="k">true</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">||</span> <span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">ICssExpression</span><span class="p">&gt;(</span><span class="k">true</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
    <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">InCssExpression</span><span class="p">();</span>
  <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">ICssPropertyStatement</span><span class="p">&gt;(</span><span class="k">true</span><span class="p">).</span><span class="n">IfNotNull</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">Property</span><span class="p">.</span><span class="n">IfNotNull</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">ColonToken</span><span class="p">.</span><span class="n">IfNotNull</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">n</span><span class="p">.</span><span class="n">GetTreeStartOffset</span><span class="p">()</span> <span class="p">&lt;</span> <span class="n">element</span><span class="p">.</span><span class="n">GetTreeStartOffset</span><span class="p">()))))</span>
    <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">InCssExpression</span><span class="p">();</span>
  <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">IMediaFeature</span><span class="p">&gt;(</span><span class="k">true</span><span class="p">).</span><span class="n">IfNotNull</span><span class="p">(</span><span class="n">f</span> <span class="p">=&gt;</span> <span class="n">f</span><span class="p">.</span><span class="n">ColonToken</span><span class="p">.</span><span class="n">IfNotNull</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">n</span><span class="p">.</span><span class="n">GetTreeStartOffset</span><span class="p">()</span> <span class="p">&lt;</span> <span class="n">element</span><span class="p">.</span><span class="n">GetTreeStartOffset</span><span class="p">()))</span> <span class="p">)</span>
    <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">InCssExpression</span><span class="p">();</span>
  <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">ICssPropertyStatement</span><span class="p">&gt;(</span><span class="k">true</span><span class="p">)</span> <span class="p">==</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">IMediaFeature</span><span class="p">&gt;(</span><span class="k">true</span><span class="p">)</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">ICssBlock</span><span class="p">&gt;()</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">||</span> <span class="n">element</span><span class="p">.</span><span class="n">GetContainingNode</span><span class="p">&lt;</span><span class="n">IMediaQueryList</span><span class="p">&gt;()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
      <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">InCssStatement</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<p>The call to <code class="code highlight language-text">LiveTemplatesManager.GetPrefix</code> gets the “word” that precedes the current text caret position. It is used here to find the position in the document that marks the start of the context of the scope point. This position is used to retrieve the node from the abstract syntax tree, which can then be used to see if the scope point is inside an expression or a statement, or so on.</p>

<p>A “word” is defined as any character preceding the current text caret that is a letter or digit, or is one of a set of allowed characters. The overload shown above does not specify any additional characters, so uses the default of the underscore character <code class="code highlight language-text">&#39;_&#39;</code>. Another overload takes an array of allowed chars.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetPrefix</span><span class="p">(</span><span class="n">IDocument</span> <span class="n">document</span><span class="p">,</span> <span class="kt">int</span> <span class="n">caretOffset</span><span class="p">,</span> <span class="k">params</span> <span class="kt">char</span><span class="p">[]</span> <span class="n">allowedChars</span><span class="p">)</span></code></pre>

<p>For example, the <code class="code highlight language-text">HTMLScopeProvider</code> class calls <code class="code highlight language-text">GetPrefix</code> with an array of <code class="code highlight language-text">{ &#39;_&#39; }</code> when fetching the prefix for file scope, and uses <code class="code highlight language-text">{ &#39;_&#39;, &#39;&lt;&#39;, &#39;:&#39; }</code> when fetching the prefix for tag scope.</p>

<a name="implementing-a-custom-scope-point" class="elem-anchor"></a>
<h2>Implementing a custom scope point<a href="#implementing-a-custom-scope-point" class="anchor-link"><span></span></a></h2>

<p>A scope point is implemented by deriving from <code class="code highlight language-text">ITemplateScopePoint</code>, and is usually implemented by deriving from the <code class="code highlight language-text">TemplateScopePoint</code> abstract base class. It is not a component from the Component Model, but just a class created by an <code class="code highlight language-text">IScopeProvider</code>. The interface is:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">ITemplateScopePoint</span>
<span class="p">{</span>
  <span class="kt">bool</span> <span class="nf">IsSubsetOf</span><span class="p">(</span><span class="n">ITemplateScopePoint</span> <span class="n">other</span><span class="p">);</span>
  <span class="kt">string</span> <span class="n">Prefix</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">string</span> <span class="nf">CalcPrefix</span><span class="p">(</span><span class="n">IDocument</span> <span class="n">document</span><span class="p">,</span> <span class="kt">int</span> <span class="n">caretOffset</span><span class="p">);</span>
<span class="na">  [NotNull]</span> <span class="n">XmlElement</span> <span class="n">WriteToXml</span><span class="p">(</span><span class="n">XmlElement</span> <span class="n">element</span><span class="p">);</span>
  <span class="kt">string</span> <span class="n">PresentableShortName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">PsiLanguageType</span> <span class="n">RelatedLanguage</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">Guid</span> <span class="n">UID</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
  <span class="n">Guid</span> <span class="nf">GetDefaultUID</span><span class="p">();</span>
  <span class="kt">string</span> <span class="nf">GetTagName</span><span class="p">();</span>
  <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Pair</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span>  <span class="n">EnumerateCustomProperties</span><span class="p">();</span>
<span class="p">}</span></code></pre>

<ul>
  <li><strong><code class="code highlight language-text">IsSubsetOf</code></strong></li>
  <li><strong><code class="code highlight language-text">Prefix</code></strong></li>
  <li><strong><code class="code highlight language-text">CalcPrefix</code></strong></li>
  <li><strong><code class="code highlight language-text">WriteToXml</code></strong> - used to write the scope point, including parameters, to XML. This is the complement to <code class="code highlight language-text">IScopeProvider.ReadFromXml</code>. ReSharper no longer uses this method for saving scope points, as templates are now saved in <code class="code highlight language-text">.dotSettings</code> format.</li>
  <li><strong><code class="code highlight language-text">PresentableShortName</code></strong> - a short description of the scope point, displayed in the template editor UI. Can be a static string, or reflecting the parameters, such as <code class="code highlight language-text">&quot;&#39;*.*; *.html&#39; files&quot;</code>.</li>
  <li><strong><code class="code highlight language-text">RelatedLanguage</code></strong> - returns the <code class="code highlight language-text">PsiLanguageType</code> that applies to this scope point. If the scope point is language agnostic, the default implementation from <code class="code highlight language-text">TemplateScopePoint.RelatedLanguage</code> will return <code class="code highlight language-text">null</code>.</li>
  <li><strong><code class="code highlight language-text">UID</code></strong> - a property containing the unique ID for this instance of the scope point. Automatically set when creating the scope via <code class="code highlight language-text">IScopeProvider.CreateScope</code>.</li>
  <li><strong><code class="code highlight language-text">GetDefaultUID</code></strong></li>
  <li><strong><code class="code highlight language-text">GetTagName</code></strong> - returns the short type name, saved to the <code class="code highlight language-text">.dotSettings</code> file, and used to pass to <code class="code highlight language-text">IScopeProvider.CreateScope</code>. The default implementation in the <code class="code highlight language-text">TemplateScopePoint</code> returns the short type name.</li>
  <li><strong><code class="code highlight language-text">EnumerateCustomProperties</code></strong> - returns a set of name/value string pairs listing the custom properties of the scope point. Used to save the properties to the <code class="code highlight language-text">.dotSettings</code> file format. The <code class="code highlight language-text">TemplateScopePoint</code> abstract base class returns an empty enumeration.</li>
</ul>

<p><code class="code highlight language-text">IMainScopePoint</code> used by QuickListSupport, IScopeCategoryUIProvider and SupportedQuickList</p>


                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper-devguide/app/js/main.build" data-baseurl="/resharper-devguide/" src="/resharper-devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

