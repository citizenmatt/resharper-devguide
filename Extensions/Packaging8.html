


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper-devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper-devguide/styles/styles.css"></head>
<body data-id="Extensions/Packaging8">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="packaging-and-distribution" class="elem-anchor"></a>
<h1>Packaging and Distribution<a href="#packaging-and-distribution" class="anchor-link"><span></span></a></h1>

<aside class="warning">
  <p> This topic relates to ReSharper 8, and has not been updated to ReSharper 9 or the ReSharper Platform.</p>
</aside>

<p>Once you’re done writing your plugin, you probably want to deploy it to end users. Starting with ReSharper 8, we provide support for clean and easy deployment of your plugins with the new Extension Manager. For these purposes, your plugin must be prepared as a <a href="http://docs.nuget.org/" data-bypass="yes"><span>NuGet package</span></a>. Also, there is a central place, the ReSharper Gallery, that can be used to host your plugins - it can be found at <a href="http://resharper-plugins.jetbrains.com" data-bypass="yes"><span>http://resharper-plugins.jetbrains.com</span></a>. But you can also use you own server to deploy plugins (e.g., within your company). Repositories can also be stored in a physical folder or a shared location on the network.</p>

<p>Creating a package happens in the same way as you create a package for NuGet, and requires you to use the <code class="code highlight language-text">nuget.exe</code> Command-Line Utility, which you can download from <a href="http://nuget.codeplex.com/releases" data-bypass="yes"><span>http://nuget.codeplex.com/releases</span></a>. You create a <code class="code highlight language-text">.nuspec</code> file and call <code class="code highlight language-text">nuget pack</code> and push to the repository with:</p>

<p><code class="code highlight language-text">nuget push myextension.1.0.0.nupkg -ApiKey XXX -Source https://resharper-plugins.jetbrains.com</code></p>

<aside class="note">
  <p> Calling <code class="code highlight language-text">nuget pack</code> without specifying the <code class="code highlight language-text">.nuspec</code> file causes Nuget to search for any project file (e.g., <code class="code highlight language-text">.csproj</code>) or <code class="code highlight language-text">.nuspec</code> file in the current directory and build the package file from the first one it finds. Of course, you can also specify the package file explicitly with <code class="code highlight language-text">nuget pack myplugin.nuspec</code>.</p>

  <p>You can safely ignore the warning about the assembly being outside the lib folder. Alternatively, create your package with <code class="code highlight language-text">nuget pack -NoPackageAnalysis</code>.</p>
</aside>

<a name="package-structure" class="elem-anchor"></a>
<h2>Package Structure<a href="#package-structure" class="anchor-link"><span></span></a></h2>

<p>In order to locate plugins, ReSharper searches a number of predefined locations inside the package. These locations are searched <em>recursively</em>, so you can create nested folders for keeping your plugins. Several plugins for different versions of ReSharper can be deployed in one package.</p>

<p>In terms of versioning, it’s possible to constrain the deployment to a specific version of ReSharper (the recommended option), or to specific versions of both ReSharper and Visual Studio (for example, if you need to take advantage of specific Visual Studio interfaces):</p>

<p>The general package structure should be</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_text">{Product}\{Version}\[VsVersion]\[&quot;plugins&quot;|&quot;settings&quot;|&quot;annotations&quot;]</code></pre>

<p>Where:
* <strong><code class="code highlight language-text">{Product}</code></strong> is the name of a product, e.g. “ReSharper”, “dotTrace”, “dotCover” or “dotPeek”
* <strong><code class="code highlight language-text">{Version}</code></strong> is the version of the target product in form of “v8.0”, “v8.1.1”, “v8.2.3” or “vAny”. This allows the package to contain mulitple files that are specific to different versions of a product. For example, a package can contain the plugin files for ReSharper 8.0 and 8.1. The special value “vAny” means the files are applicable to all versions of the product.
* <strong><code class="code highlight language-text">[VsVersion]</code></strong> is an optional folder to restrict your extension to a specific version of Visual Studio. This is in the form “vsX.X”, e.g. “vs10.0”, “vs11.0”, etc. If your plugin only works on a specific version of Visual Studio (for example, it enables ReSharper to use Visual Studio 2012’s preview tab), then it should be packaged in the appropriate Visual Studio specific folder (e.g. Visual Studio S2012 is “vs11.0”)
* <strong><code class="code highlight language-text">[&quot;plugins&quot;]</code></strong> is an optional subfolder where the extension manager will look to load any plugin dlls. This folder is not required if there are no plugins. Plugins <strong>must</strong> be in a version specific folder, e.g. <code class="code highlight language-text">v8.1</code>
* <strong><code class="code highlight language-text">[&quot;settings&quot;]</code></strong> is an optional subfolder for settings to deploy in the form of a standard ReSharper .DotSettings format. These settings should not be default values for a plugin’s settings - use <code class="code highlight language-text">IHaveDefaultSettingsStream</code> for this. The settings can contain Live Templates or Structural Search and Replace patterns, or override other, existing settings. The package can contain only settings, and does not require a plugin. It is recommended that settings files are placed in the <code class="code highlight language-text">vAny</code> folder.
* <strong><code class="code highlight language-text">[&quot;annotations&quot;]</code></strong> is an optional subfolder for external annotations that you may wish to deploy. Once again, there is no requirement for these annotations to be related to the plugin, and the package can contain only the external annotations, without any binary files. Note that annotations files must have a “.xml” file extension, and must be named after the assembly they’re for, or live in a directory with that assembly’s name. E.g. <code class="code highlight language-text">annotations\myAssembly.xml</code> and <code class="code highlight language-text">annotations\myAssembly\annotations.xml</code> are both valid. <code class="code highlight language-text">annotations\myAssembly.ExternalAnnotations.xml</code> is not. Annotations should be placed in the <code class="code highlight language-text">vAny</code> folder.</p>

<a name="dependency-on-resharper-package" class="elem-anchor"></a>
<h2>Dependency on “ReSharper” package<a href="#dependency-on-resharper-package" class="anchor-link"><span></span></a></h2>

<p>The <code class="code highlight language-text">.nuspec</code> file must declare a dependency on a package called “ReSharper”. This allows an extension to declare the version requirements of the host. So, if an extension requires ReSharper 8.0, it can create a dependency on ReSharper, with a minimum version of 8.0. If it also supports 8.1, it can have a dependency of 8.0 &lt;= ReSharper &lt; 8.1, or <code class="code highlight language-text">[8.0, 8.1)</code> in the nuspec format.</p>

<p>The “ReSharper” package doesn’t exist as something you can download and install, but is created and managed by the Extension Manager. It refuses to install any packages that don’t have this dependency, so we don’t try to install NuGet packages that aren’t extensions. It will also refuse to install any packages that don’t satisfy the version requirements. The version used by Extension Manager is the file version of ReSharper, not the released product version. So, the 8.0 release is actually 8.0.14.856, and the 8.0.1 release is 8.0.1000.2286. These product and file versions are both displayed in the help -&gt; about dialog. When you specify that an extension requires at least “8.0”, that is actually treated as requiring at least “8.0.0.0”. You can be more specific in your requirements, e.g. “8.0.1000” to target just 8.0.1.</p>

<a name="pre-release-packages" class="elem-anchor"></a>
<h2>Pre-release packages<a href="#pre-release-packages" class="anchor-link"><span></span></a></h2>

<p>The Extension Manager supports NuGet’s concept of pre-release packages. A NuGet package version (mostly) follows the <a href="http://semver.org" data-bypass="yes"><span>semver</span></a> standard, which is Major.Minor.Patch, e.g. 2.0.12. If the patch includes a label, e.g. 2.0.12-beta1, then the package is considered a pre-release package, and is not shown by default. The Extension Manager and the Extension Gallery both have switches to show pre-release versions, and pre-releases are highlighted as such in the Extension Manager UI.</p>

<p>This mechanism allows for pre-release versions of plugins, but also allows for supporting pre-release versions of a product. It is considered good practice to mark your packages as pre-release when targetting a version of a product that is in EAP. Since ReSharper’s APIs evolve and can introduce breaking changes during development, it is best that your packages are pre-release to indicate that they might not be stable with the current build.</p>

<p>Since a package can contain plugin files that target multiple versions of the product (e.g. ReSharper 8.0 and 8.1), you can support the EAP of 8.1 with the same package by making it pre-release. Those who want to test and use your plugin on the latest EAP version (e.g. 8.1) can opt-in to the pre-release version, and the users of 8.0 can continue using the stable version of the package, without being notified of updates. Once the product is released, you can update your package to remove the pre-release version label, and both 8.0 and 8.1 users will be prompted for update. When the 8.0 users upgrade to 8.1 of the product, they will already have the 8.1 version of the plugin installed, side by side with the 8.0 version.</p>

<p>Similarly, if users upgrade to a new version of a product before the plugin is updated, the package remains installed, but is not loaded (because the files are in the 8.0 folder, not the 8.1 folder). Since the package is still installed, when a new version is available on the gallery, the user is prompted to update.</p>

<a name="sample-package-definition" class="elem-anchor"></a>
<h2>Sample Package Definition<a href="#sample-package-definition" class="anchor-link"><span></span></a></h2>

<p>The following is a sample package nuspec definition for deploying a plugin.</p>

<p>This example states that it is compatible with any ReSharper 8.1 version, any 8.2 version, but not ReSharper 8.3 (remember, this is <strong>file</strong> version, not product version, so it will match against e.g. 8.2.1000.4556).</p>

<p>It deploys 4 different versions of the plugin, that target the combinations of ReSharper 8.1 and 8.2, and are also Visual Studio 2012 and Visual Studio 2013 specific.</p>

<p>It also deploys external annotations that are applicable to <em>all</em> versions of ReSharper.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_xml"><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;package</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;metadata&gt;</span>
    <span class="nt">&lt;id&gt;</span>MyPlugin<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0.0.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;title&gt;</span>MuPlugin Title<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;authors&gt;</span>JetBrains<span class="nt">&lt;/authors&gt;</span>
    <span class="nt">&lt;description&gt;</span>MyPlugin description.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;copyright&gt;</span>Copyright <span class="ni">&amp;#x00A9;</span> 2013 JetBrains<span class="nt">&lt;/copyright&gt;</span>
    <span class="nt">&lt;tags&gt;</span>Cool Plugin<span class="nt">&lt;/tags&gt;</span>
    <span class="nt">&lt;dependencies&gt;</span>
      <span class="nt">&lt;dependency</span> <span class="na">id=</span><span class="s">&quot;ReSharper&quot;</span> <span class="na">version=</span><span class="s">&quot;[8.1, 8.3)&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
  <span class="nt">&lt;/metadata&gt;</span>
  <span class="nt">&lt;files&gt;</span>
    <span class="nt">&lt;file</span> <span class="na">src=</span><span class="s">&quot;bin\MyPlugin\VS2012\rs81\foo.vs11.dll&quot;</span> <span class="na">target=</span><span class="s">&quot;ReSharper\v8.1\vs11.0\plugins&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;file</span> <span class="na">src=</span><span class="s">&quot;bin\MyPlugin\VS2012\rs81\foo.vs12.dll&quot;</span> <span class="na">target=</span><span class="s">&quot;ReSharper\v8.1\vs12.0\plugins&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;file</span> <span class="na">src=</span><span class="s">&quot;bin\MyPlugin\VS2012\rs82\foo.vs11.dll&quot;</span> <span class="na">target=</span><span class="s">&quot;ReSharper\v8.2\vs11.0\plugins&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;file</span> <span class="na">src=</span><span class="s">&quot;bin\MyPlugin\VS2012\rs82\foo.vs12.dll&quot;</span> <span class="na">target=</span><span class="s">&quot;ReSharper\v8.2\vs12.0\plugins&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;file</span> <span class="na">src=</span><span class="s">&quot;bin\annotations\**\*.*&quot;</span> <span class="na">target=</span><span class="s">&quot;ReSharper\vAny\annotations\&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/files&gt;</span>
<span class="nt">&lt;/package&gt;</span></code></pre>

<p>Further information about the NuSpec format can be found at [http://docs.nuget.org/docs/reference/nuspec-reference].</p>

<a name="manual-install" class="elem-anchor"></a>
<h2>Manual install<a href="#manual-install" class="anchor-link"><span></span></a></h2>

<p>The NuGet based Extension Manager is only available for Visual Studio 2010 and later, because the <code class="code highlight language-text">NuGet.Core</code> assembly and the user interface is only supported in Visual Studio 2010 and above. To support older Visual Studio versions, you would need to make available a download that will copy the plugin dlls to the appropriate locations for manual installation. This is also how plugins were supported prior to ReSharper 8. Note that settings files and external annotations are not supported as part of manual installation.</p>

<aside class="warning">
  <p> This method of installation is deprecated, as the new extension infrastructure provides more benefits, such as per-user install, automated update checks and easier discovery of new plugins.</p>
</aside>

<p>ReSharper checks several locations for plugins. You can see these by going to ReSharper -&gt; Options -&gt; Plugins and clicking “Show developer information”. The locations are searched for plugins recursively, so you can create a folder that contains your plugin files.</p>

<aside class="note">
  <p> In the following list, <code class="code highlight language-text">vX.X</code> refers to the version of ReSharper, e.g. <code class="code highlight language-text">v8.1</code>, and <code class="code highlight language-text">vsY.Y</code> is a Visual Studio version number, e.g. <code class="code highlight language-text">vs12.0</code>.</p>

  <p><code class="code highlight language-text">%LOCALAPPDATA%</code> and <code class="code highlight language-text">%APPDATA%</code> are not defined on Windows XP. They equate to the local and roaming user profile directories, respectively. For Windows XP, the values are <code class="code highlight language-text">%USERPROFILE%\Local Settings\Application Data</code> and <code class="code highlight language-text">%USERPROFILE%\Application Data</code> respectively.</p>

  <p>Also, <code class="code highlight language-text">%ProgramFiles%</code> will be <code class="code highlight language-text">%ProgramFiles(x86)%</code> on a 64 bit machine.</p>
</aside>

<ol>
  <li><code class="code highlight language-text">%ProgramFiles%\JetBrains\ReSharper\vX.X\bin\plugins</code> - (<code class="code highlight language-text">%ProgramFiles(x86)%</code> on a 64 bit machine). This folder doesn’t exist by default, and requires administrative priveleges to write to, but plugins installed here are available to</li>
  <li><code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\ReSharper\vX.X\vsY.Y\plugins</code> - Visual Studio specific plugin install</li>
  <li><code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\ReSharper\vX.X\plugins</code> - <strong>recommended install location</strong>. Per-user, not roamed</li>
  <li><code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\ReSharper\vAny\plugins</code> - <strong>not recommended</strong>. Plugins need to be recompiled per-version, so can’t work cross-version</li>
  <li><code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\DotNet\v1.0\plugins</code> - <strong>not recommended</strong> (see below)</li>
  <li><code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\DotNet\vAny\plugins</code> - <strong>not recommended</strong> (see below)</li>
  <li><code class="code highlight language-text">%APPDATA%\JetBrains\ReSharper\vX.X\vsY.Y\plugins</code> - roamed (see below)</li>
  <li><code class="code highlight language-text">%APPDATA%\JetBrains\ReSharper\vX.X\plugins</code> - roamed (see below)</li>
  <li><code class="code highlight language-text">%APPDATA%\JetBrains\ReSharper\vAny\plugins</code> - <strong>not recommended</strong>. Plugins need to be recompiled per-version, so can’t work cross-version</li>
  <li><code class="code highlight language-text">%APPDATA%\JetBrains\DotNet\v1.0\plugins</code> - <strong>not recommended</strong> (see below)</li>
  <li><code class="code highlight language-text">%APPDATA%\JetBrains\DotNet\vAny\plugins</code> - <strong>not recommended</strong> (see below)</li>
</ol>

<aside class="note">
  <p> Plugins installed into <code class="code highlight language-text">%APPDATA%</code> will be roamed with the Windows profile for domain-joined PCs. As such, file size plays an important part - the larger files are, the longer profile roaming (and login) will take. It is not recommended to install plugins here.</p>

  <p>The <code class="code highlight language-text">DotNet</code> folders were intended to support plugins common to all JetBrains .net tools. However, the .net tools do not currently share a common binary platform (though they do share a common source platform). Therefore, plugins are not compatible between .net tools. Also, the version number hasn’t been incremented to reflect changes in the platform. Therefore, these locations are not a good place to install plugins.</p>
</aside>

<a name="command-line" class="elem-anchor"></a>
<h2>Command line<a href="#command-line" class="anchor-link"><span></span></a></h2>

<p>It is also possible to load plugins specified on the command line, e.g.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_text">devenv.exe /ReSharper.Plugin foo.dll</code></pre>



                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper-devguide/app/js/main.build" data-baseurl="/resharper-devguide/" src="/resharper-devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

