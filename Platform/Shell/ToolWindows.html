


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper-devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper-devguide/styles/styles.css"></head>
<body data-id="Platform/Shell/ToolWindows">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="tool-windows" class="elem-anchor"></a>
<h1>Tool Windows<a href="#tool-windows" class="anchor-link"><span></span></a></h1>

<p>One of ReSharper’s core abilities is to present various types of tool windows. Broadly speaking, there are two varieties of tool window: one where its content structure is predefined, and one where you decide what the content of the window is.</p>

<a name="general-purpose-tool-window" class="elem-anchor"></a>
<h2>General-purpose tool window<a href="#general-purpose-tool-window" class="anchor-link"><span></span></a></h2>

<p>The general-purpose tool window typically consists of the following:</p>

<ul>
  <li><strong>Descriptor</strong> - an empty metadata-carrying class for describing the tool window particulars.</li>
  <li><strong>Registrar</strong> - a component that is used to register the tool window with the tool window manager.</li>
  <li><strong>Action</strong> - the action which, when fired, brings up the tool window.</li>
  <li>The window class, if you need one. Alternatively, you can create UI from existing building blocks.</li>
</ul>

<a name="descriptor" class="elem-anchor"></a>
<h3>Descriptor<a href="#descriptor" class="anchor-link"><span></span></a></h3>

<p>The descriptor is simply an empty class that inherits from <code class="code highlight language-text">ToolWindowDescriptor</code> and is decorated with the <code class="code highlight language-text">ToolWindowDescriptor</code> attribute. All of the configuration happens in the attribute. Here is an example:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[ToolWindowDescriptor(</span>
<span class="na">  ProductNeutralId=&quot;KeyboardHelperWindow&quot;,</span>
<span class="na">  Text=&quot;Keyboard Helper&quot;,</span>
<span class="na">  Guid=&quot;4338B272-3CD7-4DA3-98D2-4AD0025FAB86&quot;,</span>
<span class="na">  Type = ToolWindowType.SingleInstance,</span>
<span class="na">  VisibilityPersistenceScope = ToolWindowVisibilityPersistenceScope.Global,</span>
<span class="na">  Icon = typeof(Resources.ServicesThemedIcons.Keyboard),</span>
<span class="na">  InitialDocking = ToolWindowInitialDocking.Right</span>
<span class="na">  )]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">KeyboardHelperDescriptor</span> <span class="p">:</span> <span class="n">ToolWindowDescriptor</span>
<span class="p">{</span>
<span class="p">}</span></code></pre>

<p>Let us briefly go over the information that is provided in the above:</p>

<ul>
  <li><strong>ProductNeutralId</strong> - this is the tool window’s identifier. Note that, unlike with Actions, this identifier isn’t used for instantiation.</li>
  <li><strong>Text</strong> - the text that appears in the title of the tool window.</li>
  <li><strong>Guid</strong> - a unique identifier for this window. Use the <code class="code highlight language-text">nguid</code> live template to make one.</li>
  <li><strong>Type</strong> - determines whether the tool window is single- or multi-instance.</li>
  <li><strong>VisibilityPersistenceScope</strong> - controls how the tool window’s visibility is recorded. The tool window’s visibility can be associated with a particular solution, or can be global, i.e., apply to all solutions.</li>
  <li><strong>Icon</strong> - the type of a resource identifier for the icon that appears in the tool window.</li>
  <li><strong>InitialDocking</strong> specifies the initial part of the window in which the tool window is docked when shown.</li>
</ul>

<a name="action" class="elem-anchor"></a>
<h3>Action<a href="#action" class="anchor-link"><span></span></a></h3>

<p>To create an action that opens up a tool window, simply create a class that inherits from <code class="code highlight language-text">ActivateToolWindowHandle&lt;TDescriptorType&gt;</code>, parameterise it with your descriptor type (as seen above) and decorate it with the <code class="code highlight language-text">ActionHandler</code> attribute:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[ActionHandler(&quot;MyPlugin.ShowKeyboardHelper&quot;)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">KeyboardHelperAction</span> <span class="p">:</span> <span class="n">ActivateToolWindowActionHandler</span><span class="p">&lt;</span><span class="n">KeyboardHelperDescriptor</span><span class="p">&gt;</span>
<span class="p">{</span>
<span class="p">}</span></code></pre>

<a name="registrar" class="elem-anchor"></a>
<h3>Registrar<a href="#registrar" class="anchor-link"><span></span></a></h3>

<p>The registrar is a component (it can be shell or solution) that is used to register the tool window class with the tool window manager. Actual UI creation happens here. The UI can be created in one of the two ways.</p>

<p>The first option is to simply use a <code class="code highlight language-text">UserControl</code> (it can be either WinForms or WPF):</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[ShellComponent]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">KeyboardHelperRegistrar</span>
<span class="p">{</span>
  <span class="k">private</span> <span class="k">readonly</span> <span class="n">Lifetime</span> <span class="n">lifetime</span><span class="p">;</span>
  <span class="k">private</span> <span class="k">readonly</span> <span class="n">ToolWindowClass</span> <span class="n">toolWindowClass</span><span class="p">;</span>

  <span class="k">public</span> <span class="nf">KeyboardHelperRegistrar</span><span class="p">(</span><span class="n">Lifetime</span> <span class="n">lifetime</span><span class="p">,</span> <span class="n">ToolWindowManager</span> <span class="n">toolWindowManager</span><span class="p">,</span> <span class="n">IVsUIShell</span> <span class="n">shell</span><span class="p">,</span>
    <span class="n">IActionManager</span> <span class="n">actionManager</span><span class="p">,</span> <span class="n">IShortcutManager</span> <span class="n">shortcutManager</span><span class="p">,</span> <span class="n">KeyboardHelperDescriptor</span> <span class="n">descriptor</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="n">lifetime</span> <span class="p">=</span> <span class="n">lifetime</span><span class="p">;</span>

    <span class="n">toolWindowClass</span> <span class="p">=</span> <span class="n">toolWindowManager</span><span class="p">.</span><span class="n">Classes</span><span class="p">[</span><span class="n">descriptor</span><span class="p">];</span>
    <span class="n">toolWindowClass</span><span class="p">.</span><span class="n">RegisterEmptyContent</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">lt</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="kt">var</span> <span class="n">window</span> <span class="p">=</span> <span class="k">new</span> <span class="n">KeyboardHelperWindow</span><span class="p">(</span><span class="n">shell</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">window</span><span class="p">.</span><span class="n">BindToLifetime</span><span class="p">(</span><span class="n">lt</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<p>Another alternative it to construct the UI <em>in situ</em>, without creating a separate control class. To do this, you can use ReSharper-provided controls (such as <code class="code highlight language-text">RichTextBox</code>) and subsequently use the same <code class="code highlight language-text">BindToLifetime()</code> method in much the same fashion.</p>



                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper-devguide/app/js/main.build" data-baseurl="/resharper-devguide/" src="/resharper-devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

