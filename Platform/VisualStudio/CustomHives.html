


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper/devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper/devguide/styles/styles.css"></head>
<body data-id="Platform/VisualStudio/CustomHives">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="running-resharper-in-visual-studio-experimental-instance" class="elem-anchor"></a>
<h1>Running ReSharper in Visual Studio Experimental Instance<a href="#running-resharper-in-visual-studio-experimental-instance" class="anchor-link"><span></span></a></h1>

<aside class="warning">
  <p> This topic relates to ReSharper 8, and has not been updated to ReSharper 9 or the ReSharper Platform.</p>
</aside>

<p>Visual Studio’s <a href="http://msdn.microsoft.com/en-us/library/bb166560.aspx" data-bypass="yes"><span>“Experimental Instance”</span></a> feature is intended for developing and debugging Visual Studio extensions, and maintains a separate copy of the configuration needed to run Visual Studio. Each experimental instance can have an entirely different configuration, from theme and window layout to the extensions that are loaded.</p>

<aside class="note">
  <p> “Experimental instances” were previously known as “custom hives”</p>
</aside>

<p>By default, ReSharper (and the other .net tools, dotCover, dotMemory, dotTrace, etc.) are installed as per-machine Visual Studio extensions. This means that they are available to all users on the machine, but also that they are loaded in all experimental instances.</p>

<p>The Platform layer that provides Visual Studio integration to ReSharper and the other .net tools, has support to move its registration from per-machine to per-user, and per-experimental instance. This allows for ReSharper (dotTrace, et al) to not be loaded in experimental instances, should the need arise.</p>

<aside class="note">
  <p> The information in this article relates to all .net tools that integrate with Visual Studio. From here on, they will be collectively described as “ReSharper”, but the information equally applies to dotCover, dotMemory and dotTrace.</p>
</aside>

<a name="moving-to-a-per-user-install" class="elem-anchor"></a>
<h2>Moving to a per-user install<a href="#moving-to-a-per-user-install" class="anchor-link"><span></span></a></h2>

<p>ReSharper will handle moving the registration from per-machine to per-user automatically. When you run ReSharper in Internal mode, ReSharper will check and prompt to move to a per-user install (this process is deferred until initialisation is complete, and may take a couple of seconds). This is not the same as moving to an experimental instance, but will instead register ReSharper to run in the default Visual Studio instance. However, once moved, it will <em>only</em> run in the default instance, and not run in any experimental instances.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_text">devenv.exe /ReSharper.Internal</code></pre>

<aside class="note">
  <p> The command line for the other products is the same, replacing <code class="code highlight language-text">ReSharper.Internal</code> with <code class="code highlight language-text">dotCover.Internal</code>, <code class="code highlight language-text">dotMemory.Internal</code> or <code class="code highlight language-text">dotTrace.Internal</code>.</p>
</aside>

<p><img src="relocate_to_per_user.png" alt="Dialog offering to relocate to a per-user registration" /></p>

<p>If you click “Yes, make the extension run in this hive only”, ReSharper will restart Visual Studio as admin, and move the registration files from the Visual Studio <code class="code highlight language-text">Common7\IDE\Extensions</code> folder in <code class="code highlight language-text">Program Files</code> to <code class="code highlight language-text">%LOCALAPPDATA%\Microsoft\VisualStudio\X.X\Extensions</code>, where <code class="code highlight language-text">X.X</code> is the version of Visual Studio (this is supported for Visual Studio 2010+). ReSharper will also update the <code class="code highlight language-text">HKCU\Software\Microsoft\VisualStudio\X.X\ExtensionManager\EnabledExtensions</code> registry key to add the new location as an enabled extension.</p>

<aside class="warning">
  <p> Moving the registration from per-machine to per-user means that only the current user will be able to run ReSharper. All other users will not see ReSharper in their Visual Studio. They will also need to go through this process, by first resetting ReSharper to a per-machine install, which won’t affect the existing user’s per-user registration. To reset the per-machine install, repair the install.</p>
</aside>

<a name="moving-to-an-experimental-instance" class="elem-anchor"></a>
<h2>Moving to an experimental instance<a href="#moving-to-an-experimental-instance" class="anchor-link"><span></span></a></h2>

<p>Moving to an experimental instance is the same process as moving to a per-user install, except you need to be running in the experimental instance. Once you’ve created an experimental instance, and assuming ReSharper is still installed per-machine, run Visual Studio in the experimental instance, and with the internal flag:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_text">devenv.exe /RootSuffix MyExpInstance /ReSharper.Internal</code></pre>

<p>The same dialog will be displayed, and the per-machine registration moved to the experimental instance. ReSharper will now only load in the experimental instance.</p>

<p><img src="relocate_to_custom_hive.png" alt="Dialog offering to relocate to an experimental instance" /></p>

<p>If you have already moved the per-machine registration to be per-user, this technique won’t work, as the per-user install only loads in the default Visual Studio instance. You need to repair the ReSharper install first, in order to restore the per-machine registration. This won’t affect the per-user registration.</p>

<a name="resetting-the-relocation-dialog" class="elem-anchor"></a>
<h2>Resetting the relocation dialog<a href="#resetting-the-relocation-dialog" class="anchor-link"><span></span></a></h2>

<p>If you uncheck the “Participate in the Experimental Hive Assistance Program” checkbox, ReSharper will no longer check for per-machine registration at startup, and will no longer display the dialog.</p>

<p>To reset this, you need to manually edit the <code class="code highlight language-text">%APPDATA%\JetBrains\ReSharper\vAny\GlobalSettingsStorage.dotSettings</code> file (this is for advanced users, expect to get your hands dirty!). Search for the string <code class="code highlight language-text">vsix</code> and remove any XML elements that contain it, particularly this one:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_xml"><span class="nt">&lt;s:Boolean</span> <span class="na">x:Key=</span><span class="s">&quot;/Default/Housekeeping/JumpVsixFromMachineToPerUser/IsEnabled/@EntryValue&quot;</span><span class="nt">&gt;</span>False<span class="nt">&lt;/s:Boolean&gt;</span></code></pre>

<p>The next time you restart Visual Studio with ReSharper in internal mode, ReSharper will check, and display the dialog again.</p>

<a name="side-by-side-install-of-multiple-versions" class="elem-anchor"></a>
<h2>Side-by-side install of multiple versions<a href="#side-by-side-install-of-multiple-versions" class="anchor-link"><span></span></a></h2>

<p>It is possible, although perhaps not very desirable, to have multiple versions of ReSharper or other .net tools installed side-by-side, by making use of experimental instances.</p>

<ol>
  <li>First, move the current install of ReSharper to an experimental instance, as detailed above (note that versions of ReSharper prior to 8.2 had a bug that didn’t update the path to the extensions folder correctly in the registry, and 7.x requires to be manually run as admin)</li>
  <li>When installing the new version of ReSharper, ensure that you select “Advanced” options in the installer, and uncheck the option to remove all previous versions</li>
  <li>After installing, move the new version of ReSharper to a per-user install, by running with the internal flag. If the dialog doesn’t popup, check the <code class="code highlight language-text">GlobalSettingsStorage.dotSettings</code> file as detailed above.</li>
</ol>



                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper/devguide/app/js/main.build" data-baseurl="/resharper/devguide/" src="/resharper/devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

