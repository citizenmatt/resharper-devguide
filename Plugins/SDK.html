


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper-devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper-devguide/styles/styles.css"></head>
<body data-id="Plugins/SDK">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="sdk-reference" class="elem-anchor"></a>
<h1>SDK Reference<a href="#sdk-reference" class="anchor-link"><span></span></a></h1>

<aside class="warning">
  <p> This topic relates to ReSharper 8, and has not been updated to ReSharper 9 or the ReSharper Platform.</p>
</aside>

<p>The ReSharper SDK is a set of Visual Studio project and item templates designed to help you create and build ReSharper plugins. You can download it <a href="http://www.jetbrains.com/resharper/download/" data-bypass="yes"><span>here</span></a>.</p>

<a name="whats-in-the-sdk" class="elem-anchor"></a>
<h2>What’s in the SDK<a href="#whats-in-the-sdk" class="anchor-link"><span></span></a></h2>

<p>The SDK installs <strong>Visual Studio project and item templates</strong>. The project templates are for quickly creating projects for your plugins and for plugin tests. The item templates are for adding skeleton implementations of common extension points to an existing project.</p>

<p>The project templates also include a <strong>copy of the SDK and test NuGet packages</strong>, which are automatically added as NuGet references to the created projects.</p>

<p>The SDK also installs some <strong>sample plugins</strong> into the <code class="code highlight language-text">Program Files\JetBrains\ReSharper\v8.2\SDK\Samples</code> folder. Since this folder lives under <code class="code highlight language-text">Program Files</code>, the files cannot be edited here. To use the samples, you must copy the folders to a writable location.</p>

<a name="getting-started" class="elem-anchor"></a>
<h2>Getting Started<a href="#getting-started" class="anchor-link"><span></span></a></h2>

<p>To get a feel for the way in which plugins are developed, make a writable copy of the <code class="code highlight language-text">SamplePlugin</code> folder from the <code class="code highlight language-text">SDK\Samples</code>. This project illustrates the following ReSharper features:</p>

<ul>
  <li>A code cleanup module</li>
  <li>A context action</li>
  <li>A daemon stage</li>
  <li>An element problem analyzer</li>
  <li>A quick-fix</li>
</ul>

<p>Of course, the SDK itself is not limited to just these extension points; there are many more available.</p>

<p>Once you’ve familiarized yourself with the sample project, go ahead and create one of your own! The project templates for ReSharper plugins are available for both Visual Basic and Visual C#. Corresponding test project templates are also available.</p>

<aside class="note">
  <p> ReSharper plugin development is a lot easier if you use the tools such as the Psi Viewer which are available in ReSharper’s Internal Mode. To enable Internal Mode, edit Visual Studio’s shortcut, adding the string <code class="code highlight language-text">/ReSharper.Internal</code> to the end. Restart Visual Studio to see an additional Internal menu under the ReSharper top-level menu.</p>
</aside>

<a name="samples" class="elem-anchor"></a>
<h2>Samples<a href="#samples" class="anchor-link"><span></span></a></h2>

<p>The SDK comes with three sets of samples, all of which demonstrate the different aspects of ReSharper that can be extended.</p>

<p>First, in the <code class="code highlight language-text">SamplePlugin</code> folder, we have a plugin that shows how a single feature - the option to convert <code class="code highlight language-text">int.MaxValue</code> integer literals into correspondingly named constants. The <code class="code highlight language-text">SamplePlugin</code> shows how to implement the following features:</p>

<ul>
  <li>Action</li>
  <li>Context Action</li>
  <li>Quick-Fix</li>
  <li>Daemon Stage</li>
  <li>Problem Analyzer</li>
  <li>Code Cleanup</li>
  <li>Options Page</li>
  <li>Settings</li>
</ul>

<p>as well as the associated tests.</p>

<aside class="note">
  <p> Unfortunately, the <code class="code highlight language-text">SamplePlugin</code> project that ships with the 8.2 SDK expects the <code class="code highlight language-text">packages</code> folder to be in the folder <em>above</em> the location of the solution file. NuGet’s package restore will restore the packages to the <code class="code highlight language-text">packages</code> folder at the same location as the solution.</p>

  <p>To fix this, please replace the two <code class="code highlight language-text">.csproj</code> files with these: <a href="SamplePlugin.csproj"><span>SamplePlugin.csproj</span></a> and <a href="SamplePlugin.Tests.csproj"><span>SamplePlugin.Tests.csproj</span></a>. They are the same as the existing <code class="code highlight language-text">.csproj</code> files, except any references to <code class="code highlight language-text">..\..\packages\...</code> have been replaced with <code class="code highlight language-text">..\packages\...</code></p>

  <p>This will be fixed in a future update to the SDK.</p>
</aside>

<p>The second set of examples is the ReSharper PowerToys. The PowerToys contain several projects illustrating different features of ReSharper extensibility, as shown in the table below.</p>

<ul>
  <li><strong>CyclomaticComplexity:</strong> Daemon Stage, Highlighting, Options Page, Settings</li>
  <li><strong>ExploreTypeInterface:</strong> Action, Tool Window</li>
  <li><strong>FindText:</strong> Action, Search</li>
  <li><strong>GenerateDispose:</strong> Generator</li>
  <li><strong>Gist:</strong> Action, Settings, OptionsPage</li>
  <li><strong>LiveTemplatesMacro:</strong> Live Template Macro</li>
  <li><strong>MakeMethodGeneric:</strong> Refactoring</li>
  <li><strong>MenuItem:</strong> Action</li>
  <li><strong>OptionsPage:</strong> Settings, Options Page</li>
  <li><strong>Xml and Html:</strong> Context Action</li>
  <li><strong>ZenCoding:</strong> Action, Options Page</li>
</ul>

<p>The third set of examples involves the Psi language plugin contained in the <code class="code highlight language-text">PsiPlugin</code> and <code class="code highlight language-text">PsiPluginTest</code> folders. This set of examples illustrate the concepts used in developing support for new languages for ReSharper. Further details are outlined in the following section.</p>

<a name="sdk-nuget-package" class="elem-anchor"></a>
<h2>SDK NuGet package<a href="#sdk-nuget-package" class="anchor-link"><span></span></a></h2>

<p>The SDK NuGet package bundles not just the assemblies required to build a plugin, but also MSBuild targets files and tools. If you look in the <code class="code highlight language-text">JetBrains.ReSharper.SDK</code> package folder, you’ll see the following folders:</p>

<ul>
  <li><strong>bin</strong> - the SDK NuGet package doesn’t use a lib folder, since NuGet will automatically add these files as direct references in your .csproj file. The major downside of this is that it’s not possible to set <code class="code highlight language-text">CopyLocal</code> to <code class="code highlight language-text">False</code> on these files, so they would always get (unnecessarily) copied to the output directory. Instead, the SDK NuGet package stores the assemblies in the <code class="code highlight language-text">bin</code> folder, and adds references to them with targets defined in the <code class="code highlight language-text">build</code> folder.</li>
  <li><strong>build</strong> - contains MSBuild targets and props files to add references to the assemblies in the bin folder, setting <code class="code highlight language-text">CopyLocal</code> to <code class="code highlight language-text">False</code> for a plugin project, and <code class="code highlight language-text">True</code> for test projects. It also sets up custom tasks and ensures several native dlls are copied to the output directory for tests.</li>
  <li><strong>tools</strong> - contains two further folders, <code class="code highlight language-text">MSBuild</code> and <code class="code highlight language-text">PsiGen</code></li>
  <li><strong>tools\MSBuild</strong> - contains various custom MSBuild tasks and targets, such as compiling icons to identifiers</li>
  <li><strong>tools\PsiGen</strong> - contains several tools, related to adding PSI language support to plugins. It includes a token generator, a lexer (CsLex) and a custom parser creator, which converts .psi files to parser classes. These are demonstrated in the <code class="code highlight language-text">PsiPlugin</code> sample.</li>
</ul>

<a name="updating-existing-projects" class="elem-anchor"></a>
<h2>Updating Existing Projects<a href="#updating-existing-projects" class="anchor-link"><span></span></a></h2>

<p>If you have an existing project that already targets a previous version of ReSharper, you can update to the latest SDK by simply updating the NuGet dependencies. E.g. assuming you were targeting ReSharper 8.1, you could update to support ReSharper 8.2 by updating the SDK NuGet package from 8.1.555 to 8.2.1158.</p>

<a name="running-your-project" class="elem-anchor"></a>
<h2>Running Your Project<a href="#running-your-project" class="anchor-link"><span></span></a></h2>

<p>To get your plugin running inside Visual Studio, you need to tell ReSharper to load it. You can use the <code class="code highlight language-text">/ReSharper.Plugin</code> command line argument for this, passing in the path to your plugin’s dll. Something like:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_text">devenv.exe /ReSharper.Plugin MyPlugin.dll</code></pre>

<p>Once ReSharper has loaded, you can look at the Plugins page in the Options dialog to see if it’s loaded correctly. You can expand the “Show Details” and “Show Additional Developer Information” panels to get more information about how ReSharper is loading your plugin.</p>

<p>Note that you can’t load a plugin on the command line that is already loaded! You must ensure that the plugin isn’t installed locally (e.g. <code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\ReSharper\v8.2\plugins</code>) or installed as part of an extension. Please uninstall before trying to debug your plugin.</p>

<p>The SDK project templates set the debug command line options for this by default.</p>

<a name="testing-your-project" class="elem-anchor"></a>
<h2>Testing Your Project<a href="#testing-your-project" class="anchor-link"><span></span></a></h2>

<p>ReSharper contains project templates to create test projects. These projects add a reference to both the <code class="code highlight language-text">JetBrains.ReSharper.SDK</code> and the <code class="code highlight language-text">JetBrains.ReSharper.SDK.Tests</code> NuGet packages.</p>

<p>ReSharper’s tests are acceptance tests. They create an in-memory ReSharper environment, and open a project and process a file. The result of the process is stored in a file and compared against a “gold” file. If the files are the same, the test passes. If not, the test fails.</p>

<p>The location of the test folder is determined by walking up the directory structure from the test assembly looking for a <code class="code highlight language-text">test\data</code> path. Conventionally, the solution directory contains two folders - <code class="code highlight language-text">src</code> and <code class="code highlight language-text">test</code>. The <code class="code highlight language-text">src</code> folder contains the plugin project and source, the <code class="code highlight language-text">test</code> folder contains a <code class="code highlight language-text">src</code> folder and a <code class="code highlight language-text">data</code> folder for the test project and data, respectively.</p>

<p>Test files also support control identifiers. For example, to indicate the placement of the caret, one can use the <code class="code highlight language-text">{caret}</code> identifier right in the input/gold files.</p>

<a name="continuous-integration" class="elem-anchor"></a>
<h2>Continuous Integration<a href="#continuous-integration" class="anchor-link"><span></span></a></h2>

<p>The SDK NuGet packages are intended to be used with NuGet’s package restore feature. You do not need to commit your <code class="code highlight language-text">packages</code> folder to source control.</p>

<a name="where-to-get-help" class="elem-anchor"></a>
<h2>Where to Get Help<a href="#where-to-get-help" class="anchor-link"><span></span></a></h2>

<p>If you have a problem, don’t hesitate to contact us - we are always happy to help! You can write a comment under one of these Confluence pages, write an SDK-related feature requires in our <a href="http://youtrack.jetbrains.net/dashboard" data-bypass="yes"><span>YouTrack tracker</span></a>, tweet us <a href="http://twitter.com/resharper" data-bypass="yes"><span>@resharper</span></a> or <a href="http://twitter.com/jetbrains" data-bypass="yes"><span>@jetbrains</span></a> or leave a message at the <a href="http://devnet.jetbrains.net/community/resharper/resharper_community?view=discussions" data-bypass="yes"><span>ReSharper Discussion Forums</span></a>. The choice is yours!</p>



                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper-devguide/app/js/main.build" data-baseurl="/resharper-devguide/" src="/resharper-devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

