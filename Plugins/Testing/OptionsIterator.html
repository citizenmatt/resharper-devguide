


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper-devguide/app/css/styles.min.css">
<link  rel="stylesheet" href="/resharper-devguide/styles/styles.css"></head>
<body data-id="Plugins/Testing/OptionsIterator">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="mailto:feedback@jetbrains.com">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="combinatorial-testing" class="elem-anchor"></a>
<h1>Combinatorial Testing<a href="#combinatorial-testing" class="anchor-link"><span></span></a></h1>

<p>The test framework supports running the same test multiple times with different combinations of settings. The settings can be specified in a text file, via an attribute, or via a parameter embedded in the test input file. The base class for the test must support this explicitly, it is not available to all tests by default.</p>

<aside class="note">
  <p> The combinatorial testing described here is in regard to running a piece of test code multiple times within the same test method run, with different settings applied for each run. It does not cause multiple NUnit test methods to run, and the standard NUnit <code class="code highlight language-text">[TestCase]</code> and <code class="code highlight language-text">[TestCaseSource]</code> attributes continue to work very nicely for row based, data driven testing.</p>
</aside>

<p>When running the test, the test base class needs to call the <code class="code highlight language-text">Iterate</code> method on an instance of <code class="code highlight language-text">TestOptionsIterator</code>:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="n">ExecuteWithGold</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span> <span class="n">writer</span> <span class="p">=&gt;</span>
  <span class="n">myTestOptionsIterator</span><span class="p">.</span><span class="n">Iterate</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">settingsStore</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">Solution</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">writer1</span><span class="p">)</span> <span class="p">=&gt;</span>
  <span class="p">{</span>
    <span class="c1">// Run the test, output to writer1</span>
  <span class="p">})</span>
<span class="p">);</span></code></pre>

<p>The instance of <code class="code highlight language-text">TestOptionsIterator</code> is usually created in the constructor:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="nf">MyTest</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">myTestOptionsIterator</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TestOptionsIterator</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">ReportUnaffected</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}</span></code></pre>

<p>When running, the options iterator will run the test multiple times, once for each combination of configured settings. The results are all written to the same <code class="code highlight language-text">.tmp</code> file, separated by a marker line, and listing details of the settings that were valid for that run. Once the run is complete, the <code class="code highlight language-text">.tmp</code> file is compared against the <code class="code highlight language-text">.gold</code> file. If there are any differences, the test fails.</p>

<p>The <code class="code highlight language-text">ReportUnaffected</code> property controls how the runs are output. If the value is set to <code class="code highlight language-text">true</code>, then each combination of settings is output. If set to <code class="code highlight language-text">false</code>, only combinations of settings that produce a previously unseen value are output. This is normally handled by the base class of the item you’re trying to test, and is not usually available to change.</p>

<a name="describing-combinations" class="elem-anchor"></a>
<h2>Describing combinations<a href="#describing-combinations" class="anchor-link"><span></span></a></h2>

<p>Combinations of options are specified with a JavaScript-like DSL. A JavaScript expression describes a set of options and how they are to be combined.</p>

<p>At the simplest, an object literal is used as a collection of name/value pairs to set options and their values.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span>
  <span class="nx">TagAttributesFormat</span><span class="o">:</span> <span class="nx">OnSingleLine</span><span class="p">,</span>
  <span class="nx">MaxSingleLineTagLength</span><span class="o">:</span> <span class="mi">10</span>
<span class="p">}</span></code></pre>

<p>Values in the object literal can be string literals, numerals, or unquoted values (this is JavaScript-like, not JSON). Enum values, booleans and numerals are automatically parsed and converted to the appropriate type.</p>

<p>In order to support combinations of options, the value of the property can be an array literal. The array lists all of the values that should be applied to that property.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span>
  <span class="nx">TagAttributesFormat</span><span class="o">:</span> <span class="p">[</span><span class="nx">OnSingleLine</span><span class="p">,</span> <span class="nx">OnDifferentLines</span><span class="p">],</span>
  <span class="nx">MaxSingleLineTagLength</span><span class="o">:</span> <span class="mi">10</span>
<span class="p">}</span></code></pre>

<p>Given this configuration, the test will run twice, once for <code class="code highlight language-text">OnSingleLine, 10</code> and again for <code class="code highlight language-text">OnDifferentLines, 10</code>. Given another property with an array literal, the test will be run for all combinations of all values. Adding more properties, with more options, can very quickly increase the number of times the test is run.</p>

<p>Instead of creating an array literal with all enum values listed, the object literal property can use the special value <code class="code highlight language-text">&quot;all&quot;</code> or the wildcard <code class="code highlight language-text">&quot;*&quot;</code>, which when applied to an enum option will run a combination of all values for that option property.</p>

<a name="property-names" class="elem-anchor"></a>
<h3>Property names<a href="#property-names" class="anchor-link"><span></span></a></h3>

<p>In order to know what options the property names map to, the test class and its base classes can use the <code class="code highlight language-text">[TestSettingsKey]</code> attribute to specify one or more settings key, as used by ReSharper’s settings system.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[TestSettingsKey(typeof(HtmlFormatterSettingsKey))]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">HtmlCodeFormatterTests</span> <span class="p">:</span> <span class="n">CodeFormatterWithExplicitSettingsTestBase</span>
<span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="na">[TestSettingsKey(typeof(CommonFormatterSettingsKey))]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">CodeFormatterWithExplicitSettingsTestBase</span> <span class="c1">// : ...</span>
<span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span></code></pre>

<p>The <code class="code highlight language-text">HtmlCodeFormatterTests</code> can now use properties from <code class="code highlight language-text">HtmlFormatterSettingsKey</code> and <code class="code highlight language-text">CommonFormatterSettingsKey</code> in the object literals of the DSL. It can use each property name unqualified, or disambiguate by using the friendly name of the settings key as a qualifier:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span>
  <span class="nx">TagAttributesFormat</span><span class="o">:</span> <span class="nx">OnSingleLine</span><span class="p">,</span> <span class="c1">// Sets HtmlCodeFormatterTests.TagAttributesFormat</span>
  <span class="nx">CommonFormatting$ALIGNMENT_TAB_FILL_STYLE</span><span class="o">:</span> <span class="nx">USE_SPACES</span> <span class="c1">// Sets CommonFormatterSettingsKey.ALIGNMENT_TAB_FILL_STYLE</span>
<span class="p">}</span></code></pre>

<a name="special-property-names" class="elem-anchor"></a>
<h3>Special property names<a href="#special-property-names" class="anchor-link"><span></span></a></h3>

<p>The <code class="code highlight language-text">TestOptionsIterator</code> recognises a couple of special property names for settings that are usually controlled by Visual Studio rather than ReSharper:</p>

<ul>
  <li><code class="code highlight language-text">USE_TABS</code> is a boolean value to use tabs rather than spaces.</li>
  <li><code class="code highlight language-text">INDENT_SIZE</code> is an integer value to specify the size of an indent.</li>
</ul>

<p>Both of these values are language specific, so require a language prefix:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span>
  <span class="nx">HTML$USE_TABS</span><span class="o">:</span> <span class="nx">all</span>
<span class="p">}</span></code></pre>

<p>This example will run the test code multiple times, with the “use tabs” settings for HTML files set to <code class="code highlight language-text">true</code> and <code class="code highlight language-text">false</code>.</p>

<p>The language name is the name of the language’s <code class="code highlight language-text">PsiLanguageType</code> instance, e.g. <code class="code highlight language-text">HtmlLanguage.Name</code>, <code class="code highlight language-text">CssLanguage.Name</code>, etc.</p>

<a name="custom-property-names" class="elem-anchor"></a>
<h3>Custom property names<a href="#custom-property-names" class="anchor-link"><span></span></a></h3>

<p>Tests can also iterate over values not stored in the settings subsystem. Rather than automatically setting the option in settings before running the test, the value is made available to the test in the <code class="code highlight language-text">CustomValues</code> dictionary of the test data passed to the test function.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="n">ExecuteWithGold</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span> <span class="n">writer</span> <span class="p">=&gt;</span>
  <span class="n">myTestOptionsIterator</span><span class="p">.</span><span class="n">Iterate</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">settingsStore</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">Solution</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">writer1</span><span class="p">)</span> <span class="p">=&gt;</span>
  <span class="p">{</span>
    <span class="kt">var</span> <span class="n">customValue</span> <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;myCustomVariable&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="n">CustomType</span><span class="p">;</span>
    <span class="c1">// Run the test using customValue, output to writer1</span>
  <span class="p">})</span>
<span class="p">);</span></code></pre>

<p>The test class needs to tell the <code class="code highlight language-text">TestOptionsIterator</code> that a custom value can be used, by decorating the class (or base class) with the <code class="code highlight language-text">[TestSettingsVariable]</code> attribute. It must pass in the name and <code class="code highlight language-text">Type</code> of the variable, which can be either boolean or an enum.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[TestSettingsVariable(&quot;FormatProfile&quot;, typeof(CodeFormatProfile))]</span>
<span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">CodeFormatterWithExplicitSettingsTestBase</span> <span class="c1">// : ...</span>
<span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">enum</span> <span class="n">CodeFormatProfile</span>
<span class="p">{</span>
  <span class="n">DEFAULT</span><span class="p">,</span>
  <span class="n">INDENT</span><span class="p">,</span>
  <span class="n">GENERATOR</span><span class="p">,</span>
  <span class="n">SOFT</span><span class="p">,</span>
<span class="p">}</span></code></pre>

<p>The DSL can now use <code class="code highlight language-text">&quot;FormatProfile&quot;</code> as a property name, and provide values either as a single value, array literal or the wildcard <code class="code highlight language-text">&quot;*&quot;</code> (the <code class="code highlight language-text">&quot;all&quot;</code> value doesn’t work here). The current value will be available by calling <code class="code highlight language-text">data.CustomValues[&quot;FormatProfile&quot;]</code>.</p>

<a name="advanced-combinations" class="elem-anchor"></a>
<h2>Advanced combinations<a href="#advanced-combinations" class="anchor-link"><span></span></a></h2>

<p>The DSL can handle more constructs than just object literals. It supports:</p>

<a name="object-literals" class="elem-anchor"></a>
<h3>Object literals<a href="#object-literals" class="anchor-link"><span></span></a></h3>

<p>Used to provide name/value pairs to set options. The value can be a scalar value (such as an integer) or a collection of values.</p>

<p>If the value is a scalar, it can be a string literal, numeral, boolean or unquoted reference, in which case it’s treated as an unquoted string literal. The value is converted to the appropriate type for the setting - string, integer, boolean or enum. The magic values <code class="code highlight language-text">&quot;all&quot;</code> or <code class="code highlight language-text">&quot;*&quot;</code> are wildcards and create a combination of all of the values for the type - <code class="code highlight language-text">true</code> and <code class="code highlight language-text">false</code> for booleans, or all values for an enum.</p>

<p>To represent a collection of items, the value can be either an array literal or a nested object literal. An array literal creates a combination of all of the simple (quoted/unquoted) string values in the array. An object literal is used to create string name/value pairs to be used for an indexed setting.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span>
  <span class="nx">FileExtensions</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;*.cshtml&quot;</span> <span class="p">],</span>
  <span class="nx">TemplateMimeTypes</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;text/html&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;text/plain&quot;</span><span class="o">:</span> <span class="kc">false</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<p>This will create a combination of tests for the two values in <code class="code highlight language-text">FileExtensions</code>, and an indexed setting for <code class="code highlight language-text">TemplateMimeTypes</code> with the two keys <code class="code highlight language-text">&quot;text/html&quot;</code> and <code class="code highlight language-text">&quot;text/plain&quot;</code> to <code class="code highlight language-text">true</code> and <code class="code highlight language-text">false</code>, respectively.</p>

<p>If a property’s value is an array literal, it can further contain either an object literal, or even another array literal. This allows for creating a combination of indexed settings.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span>
  <span class="nx">FileExtensions</span><span class="o">:</span> <span class="p">[</span> <span class="p">[</span> <span class="s2">&quot;*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;*.cshtml&quot;</span> <span class="p">],</span> <span class="p">[</span> <span class="s2">&quot;*.html&quot;</span><span class="p">,</span> <span class="s2">&quot;*.vbhtml&quot;</span> <span class="p">]</span> <span class="p">],</span>
  <span class="nx">TemplateMimeTypes</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s2">&quot;text/html&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;text/plain&quot;</span><span class="o">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s2">&quot;text/html&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s2">&quot;text/plain&quot;</span><span class="o">:</span> <span class="kc">false</span> <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre>

<p>This creates a set of combinations of indexed values:</p>

<ul>
  <li><code class="code highlight language-text">*.html</code> and <code class="code highlight language-text">*.cshtml</code> is set, and the mime types are set to true</li>
  <li><code class="code highlight language-text">*.html</code> and <code class="code highlight language-text">*.cshtml</code> is set, and the mime types are set to false</li>
  <li><code class="code highlight language-text">*.html</code> and <code class="code highlight language-text">*.vbhtml</code> is set, and the mime types are set to true</li>
  <li><code class="code highlight language-text">*.html</code> and <code class="code highlight language-text">*.vbhtml</code> is set, and the mime types are set to false</li>
</ul>

<a name="array-literals" class="elem-anchor"></a>
<h3>Array literals<a href="#array-literals" class="anchor-link"><span></span></a></h3>

<p>When used inside an object literal, the behaviour is as described above.</p>

<p>Otherwise, array literals are used to create a sequential combination of its contents. That is, each item in the array literal is evaluated and the test is run. The item in the array literal must either be another array literal (which creates a new combination grouping), or an object literal, which describes the settings to apply, as above.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">[</span>
  <span class="p">{</span> <span class="nx">Reformat</span><span class="o">:</span> <span class="p">[</span> <span class="nx">True</span><span class="p">,</span> <span class="nx">False</span> <span class="p">]</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nx">HTML$USE_TABS</span><span class="o">:</span> <span class="p">[</span> <span class="nx">True</span><span class="p">,</span> <span class="nx">False</span><span class="p">]</span> <span class="p">}</span>
<span class="p">]</span></code></pre>

<p>This runs the test four times, firstly with both boolean values for <code class="code highlight language-text">Reformat</code> and secondly with both boolean values of “use tabs” for HTML files. Note that it doesn’t combine between the two - the values of “use tabs” are not modified during the two runs when <code class="code highlight language-text">Reformat</code> is modified.</p>

<a name="binary-expressions" class="elem-anchor"></a>
<h3>Binary expressions<a href="#binary-expressions" class="anchor-link"><span></span></a></h3>

<p>Binary expressions are used to combine combinations:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span> <span class="nx">Reformat</span><span class="o">:</span> <span class="nx">all</span> <span class="p">}</span> <span class="o">*</span> <span class="p">{</span> <span class="nx">HTML$USE_TABS</span><span class="o">:</span> <span class="nx">all</span> <span class="p">}</span></code></pre>

<p>This example will combine each value of the “use tabs” settings with each value of the <code class="code highlight language-text">Reformat</code> setting.</p>

<a name="reference-expressions-and-parentheses" class="elem-anchor"></a>
<h3>Reference expressions and parentheses<a href="#reference-expressions-and-parentheses" class="anchor-link"><span></span></a></h3>

<p>A simple JavaScript-like reference to a name is used to refer to common, shared combination definitions, as discussed below.</p>

<p>The DSL understands parentheses, and safely strips them. E.g. <code class="code highlight language-text">&quot;({SPACES: all} * {ALIGN: all})&quot;</code> is safely handled as a combination of setting <code class="code highlight language-text">SPACES</code> and <code class="code highlight language-text">ALIGN</code>.</p>

<a name="using-combinations" class="elem-anchor"></a>
<h2>Using combinations<a href="#using-combinations" class="anchor-link"><span></span></a></h2>

<p>There are several ways to apply the combinations to a test. The simplest way is to use the <code class="code highlight language-text">[TestSettings]</code> attribute to specify one or more combinations directly on the test class or base class. Alternatively, the combinations can come from a file that live side-by-side with the input path, or can be written, inline, into the input path.</p>

<p>If more than one method is used, the combinations are combined (as a binary expression, see the advanced combinations section above).</p>

<a name="combinations-as-attributes" class="elem-anchor"></a>
<h3>Combinations as attributes<a href="#combinations-as-attributes" class="anchor-link"><span></span></a></h3>

<p>The <code class="code highlight language-text">[TestSettings]</code> attribute can be used multiple times on a method, class or base class to provide JavaScript-like expressions to represent combinations to apply to the test.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[TestSettings(&quot;{ TagAttributeFormat: all }&quot;)]</span>
<span class="na">[Test]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Test001</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">DoNamedTest</span><span class="p">();</span>
<span class="p">}</span></code></pre>

<a name="jcnf-files" class="elem-anchor"></a>
<h3>JCNF files<a href="#jcnf-files" class="anchor-link"><span></span></a></h3>

<p>The <code class="code highlight language-text">TestOptionsIterator</code> will automatically load combinations specified in a <code class="code highlight language-text">.jcnf</code> file named after the project file being tested. For example, if the test is being run on <code class="code highlight language-text">test01.js</code>, the <code class="code highlight language-text">TestOptionsIterator</code> will try to load a file called <code class="code highlight language-text">test01.js.jcnf</code>.</p>

<p>The file should contain a set of combinations as a single object literal:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">{</span>
  <span class="nx">TagAttributesFormat</span><span class="o">:</span> <span class="nx">OnSingleLine</span><span class="p">,</span>
  <span class="nx">MaxSingleLineTagLength</span><span class="o">:</span> <span class="mi">10</span>
<span class="p">}</span></code></pre>

<p>If the <code class="code highlight language-text">TestOptionsIterator</code> sees a <code class="code highlight language-text">.dotSettings</code> file (e.g. <code class="code highlight language-text">test01.js.dotSettings</code>) it will automatically convert it to a <code class="code highlight language-text">.jcnf</code> file. The resulting file will not contain any combinations - each setting will only have one value - but it will give you a good place to start.</p>

<a name="embedded-combinations" class="elem-anchor"></a>
<h3>Embedded combinations<a href="#embedded-combinations" class="anchor-link"><span></span></a></h3>

<p>Combinations can also be embedded directly in the input file, using the <code class="code highlight language-text">SettingsIterator</code> variable:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="nx">$</span><span class="p">{</span><span class="nx">SettingsIterator</span><span class="o">:</span> <span class="p">{</span> <span class="nx">TagAttributeFormat</span><span class="o">:</span> <span class="nx">all</span> <span class="p">}</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{}</span></code></pre>

<a name="sharing-combinations" class="elem-anchor"></a>
<h3>Sharing combinations<a href="#sharing-combinations" class="anchor-link"><span></span></a></h3>

<p>Common combinations can be described in separate files, and shared and included in multiple tests. The test class, or base class needs to use one or more <code class="code highlight language-text">[TestSettingsInclude]</code> attributes to point to a file to be loaded.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[TestSettingsInclude(@&quot;codeInsight\CodeFormatter\JavaScript\common.jcnf&quot;)]</span>
<span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">JavaScriptCodeFormatterTestBase</span> <span class="p">:</span> <span class="n">CodeFormatterWithExplicitSettingsTestBase</span>
<span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span></code></pre>

<p>The file is a <code class="code highlight language-text">.jcnf</code> file as described above, however the format is slightly different. Instead of describing a single JavaScript-like object literal, the common <code class="code highlight language-text">.jcnf</code> files contain JavaScript-like variable declarations that refer to array literals that describe a combination:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="kd">var</span> <span class="nx">Align</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">&quot;Align&quot;</span><span class="p">,</span>
  <span class="p">{</span> <span class="nx">ALIGN_MULTILINE_PARAMETER</span> <span class="o">:</span> <span class="nx">all</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nx">ALIGN_MULTIPLE_DECLARATION</span> <span class="o">:</span> <span class="nx">all</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nx">ALIGN_TERNARY</span> <span class="o">:</span> <span class="nx">all</span> <span class="p">}</span>  
<span class="p">];</span></code></pre>

<p>The syntax used here is as described in the <a href="#advanced-combinations"><span>advanced combinations</span></a> section above. The first element is the name of the combination, displayed when the combination needs to be output. This example will run multiple times, for every combination of each value of each property (two boolean properties plus an enum value with three values gives twelve combinations).</p>

<p>The variable name is available to be used by the main DSL, as a simple reference to the name:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="na">[TestSettings(&quot;Align&quot;)]</span>
<span class="na">[Test]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Test001</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">DoNamedTest</span><span class="p">();</span>
<span class="p">}</span></code></pre>

<p>Or it can be combined into a binary expression:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_js"><span class="p">(</span> <span class="nx">Align</span> <span class="o">*</span> <span class="p">{</span> <span class="nx">SPACE_AROUND_BINARY_OPERATOR</span><span class="o">:</span> <span class="nx">all</span> <span class="p">}</span> <span class="p">)</span></code></pre>

<p>Which will expand the combinations by also iterating over all values of <code class="code highlight language-text">SPACE_AROUND_BINARY_OPERATOR</code> (which is a boolean).</p>



                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper-devguide/app/js/main.build" data-baseurl="/resharper-devguide/" src="/resharper-devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

